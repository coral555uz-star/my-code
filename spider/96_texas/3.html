<html><head>
		


<title>半导小芯-芯片查询工具_芯片替代查询_数据手册查询_规格书查询_datasheet查询_IC查询_国产替代</title>
<meta charset="utf-8">

<meta name="keywords" content="国产芯片，芯片替代，国产IC，国产替代，替代芯片，替代型号，数据手册，数据手册搜索，数据手册查询，规格书PDF，规格书查询，规格书搜索，datasheet，datasheet查询，alldatasheet，findchips，icpdf">
<meta name="description" content="半导小芯专注于国外和国产芯片资料查询，都在用的芯片查询工具，为您提供规格书查询，数据手册查询，datasheet查询，IC查询，替代型号查询，国产替代等相关信息，帮您快速找到数据手册、数据表、规格书、datasheet、替代型号、联系方式、技术参数、参数筛选、选型文档、技术文档、丝印Making、国产替代、样品申请、芯片PDF、代理商、应用方案、交叉参考等资料，查询更全芯片资料就到半导小芯官网！">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
<link rel="shortcut icon" href="/static/favicon.ico">
<link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="/static/layer/skin/default/layer.css">
<link rel="stylesheet" type="text/css" href="/static/jqueryPagination/css/pagination.css">
<link rel="stylesheet" type="text/css" href="/static/css/bdxx.css?v=26">


<script src="https://zz.bdstatic.com/linksubmit/push.js"></script><script src="/static/common/debug.js"></script>

<!-- 全局js -->
<script src="/static/js/jquery-3.5.1.min.js"></script>
<script src="/static/js/canvasId.js"></script>
<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/static/layer/layer.js"></script><link rel="stylesheet" href="https://www.semiee.com/static/layer/skin/default/layer.css?v=3.0.3303" id="layuicss-skinlayercss">
<script type="text/javascript" src="/static/jqueryPagination/js/pagination.min.js?v=2"></script>
<script>
    var ctx = "";
    var host = 'https://www.semiee.com/bdxx-api';
    // var host = 'http://192.168.0.15:8081/bdxx-api';

    var ddLayerIndex = null;
    // 登录失效倒计时时间
    var countdown = 5;
    // 登录失效计时器
    var timer;
    // 登录失效弹窗
    var confirmInst

    function ddShowLoading() {
        ddLayerIndex = layer.load(2);
    }

    function ddHideLoading() {
        layer.close(ddLayerIndex);
    }

    function getDeviceId() {
        var deviceid = localStorage.deviceid;
        if (deviceid) {
            return deviceid;
        } else {
            var deviceid = getCanvasId();
            localStorage.deviceid = deviceid;
            return deviceid;
        }
    }

    // 检查是否引入了 debug.js 文件
    function isDebugJsLoaded() {
        var scripts = document.getElementsByTagName('script');
        for (var i = 0; i < scripts.length; i++) {
            if (scripts[i].src.includes('/static/common/debug.js')) {
                return true;
            }
        }
        return false;
    }

    function getToken() {
        var token = localStorage.token;
        if (token) {
            return token;
        }
        return '';
    }

    function delToken() {
        localStorage.token = '';
    }

    function saveToken(token) {
        localStorage.token = token;
    }
    
    function getHistory(content) {
        var history = localStorage.history;
        if (history) {
        	var hs = JSON.parse(history);
        	var result = [];
        	$.each(hs, function(index, item) {
        		if(result.length >= 30) {
        			return false;
        		}
        		if(content != null && content != '') {
        			if(item.content.indexOf(content) != -1) {
        				result.push(item);
        			}
        		} else {
        			result.push(item);
        		}
        	});
        	return result;
        }
        return [];
    }

    function delHistory() {
        localStorage.history = '[]';
    }

    function saveHistory(history) {
        if (history == null || history.content == '') {
            return;
        }

        var list = getHistory() || []; // 确保 list 是一个数组，即使 localStorage 中没有历史记录

        var check = false;
        var existingIndex = -1;

        $.each(list, function(index, item) {
            if (history.content == item.content) {
                check = true;
                existingIndex = index;
                return false; // 退出循环
            }
        });

        if (check) {
            // 如果存在相同记录，将其移到第一个位置
            var existingItem = list.splice(existingIndex, 1)[0];
            list.unshift(existingItem);
        } else {
            // 如果不存在相同记录，直接插入到第一个位置
            list.unshift(history);
        }

        // 更新本地存储
        localStorage.setItem('history', JSON.stringify(list));
    }

    // 获取本页搜索历史记录
    function getSampleBrandKeywordHistory(content) {
        var history = localStorage.sampleBrandKeywordHistory;
        if (history) {
            var hs = JSON.parse(history);
            var result = [];
            $.each(hs, function (index, item) {
                if (content != null && content != '') {
                    if (item.content.indexOf(content) != -1) {
                        result.push(item);
                    }
                } else {
                    result.push(item);
                }
            });
            return result;
        }
        return [];
    }

    // 删除本页搜索历史记录
    function delSampleBrandKeywordHistory() {
        localStorage.sampleBrandKeywordHistory = '[]';
    }

    // 保存交叉搜索历史搜索记录
    function saveSampleBrandKeywordHistory(history) {
        if (history == null || history.content == '') {
            return;
        }
        var list = getSampleBrandKeywordHistory();
        var check = false;
        $.each(list, function (index, item) {
            if (history.content == item.content) {
                check = true;
                return false;
            }
        });
        if (!check) {
            list.splice(0, 0, history);
            localStorage.sampleBrandKeywordHistory = JSON.stringify(list);
        }
    }

    function ddAjax(url, method, vo, successcallback, failcallback, showLoading) {
        showLoading = false || showLoading;
        vo = vo || {};
        if ("GET" != method.toUpperCase()) {
            vo = JSON.stringify(vo);
        }
        // 如果 debug.js 已加载，则进行校验
        if (isDebugJsLoaded() && typeof checkDevelop === 'function') {
            if (!checkDevelop()) {
                // 校验失败，不请求接口
                return;
            }
        }
        var deviceId = getDeviceId();
        var token = getToken();

        let loadingTimer = null;
        let isCompleted = false;

        if (showLoading) {
            loadingTimer = setTimeout(function () {
                if (!isCompleted) {
                    ddShowLoading();
                }
            }, 1500);
        }

        $.ajax({
            url: url.indexOf('http://') > -1 || url.indexOf('https://') > -1 ? url : host + url,
            type: method,
            headers: {
                deviceId: deviceId,
                token: token,
                source: 1,
                os: 2
            },
            dataType: "json",
            contentType: "application/json",
            data: vo,
            // beforeSend: function () {
            //     if (showLoading) {
            //         ddShowLoading();
            //     }
            // },
            success: function (response) {
                isCompleted = true;
                if (loadingTimer) clearTimeout(loadingTimer);
                if (showLoading) ddHideLoading();

                if (response.code == 0) {
                    if (successcallback != null) {
                        successcallback(response);
                    }
                } else {
                    if (failcallback != null) {
                        if (response.message === '登录失效，请重新登录') {
                            loginFailure();
                        } else {
                            if (response.remark) {
                                failcallback(response.remark);
                            }
                        }
                    }
                }
            },
            error: function (err) {
                isCompleted = true;
                if (loadingTimer) clearTimeout(loadingTimer);
                if (showLoading) ddHideLoading();

                if (failcallback != null) {
                    failcallback(JSON.stringify(err));
                }
            },
            // complete: function () {
            //     if (showLoading) {
            //         ddHideLoading();
            //     }
            // }
        })
    }

    function loginFailure() {
        if (!confirmInst) {
            confirmInst = layer.confirm('登录失效，将在' + countdown + '秒后自动跳转首页，请重新登录', {
                closeBtn: false,
                btn: ['立即跳转（' + countdown + '）'],
                success: function (layerElem) {  // 弹窗渲染完成回调
                    // 获取确认按钮（通过layer索引）
                    var confirmBtn = $(layerElem).find('.layui-layer-btn0');

                    // 启动倒计时
                    timer = setInterval(function () {
                        countdown--;
                        confirmBtn.text('立即跳转（' + countdown + '）');

                        if (countdown <= 0) {
                            clearInterval(timer);
                            layer.close(confirmInst);  // 关闭当前弹窗
                            delToken();
                            window.location.href = ctx + '/index';
                        }
                    }, 1000);

                    // 手动点击清除定时器
                    confirmBtn.on('click', function () {
                        clearInterval(timer);
                    });
                }
            }, function (index) {  // 确认按钮回调
                layer.closeAll();
                delToken();
                window.location.href = ctx + '/index';
            });
        }
    }

    function ddPost(url, vo, successcallback, failcallback, showLoading) {
        ddAjax(url, "POST", vo, successcallback, failcallback, showLoading);
    }

    function ddGet(url, vo, successcallback, failcallback, showLoading) {
        ddAjax(url, "GET", vo, successcallback, failcallback, showLoading);
    }

    function ddUpload(url, vo, successcallback, failcallback, showLoading) {
        // 如果 debug.js 已加载，则进行校验
        if (isDebugJsLoaded() && typeof checkDevelop === 'function') {
            if (!checkDevelop()) {
                // 校验失败，不请求接口
                return;
            }
        }
        var deviceId = getDeviceId();
        var token = getToken();
        $.ajax({
            url: url.indexOf('http://') > -1 || url.indexOf('https://') > -1 ? url : host + url,
            type: 'POST',
            headers: {
                deviceId: deviceId,
                token: token,
                source: 1,
                os: 2
            },
            dataType: "json",
            contentType: false,
            processData: false,
            data: vo,
            beforeSend: function () {
                if (showLoading) {
                    ddShowLoading();
                }
            },
            success: function (response) {
                if (response.code == 0) {
                    if (successcallback != null) {
                        successcallback(response);
                    }
                } else {
                    if (failcallback != null) {
                        if (response.message === '登录失效，请重新登录') {
                            loginFailure();
                        } else {
                            if (response.remark) {
                                failcallback(response.remark);
                            }
                        }
                    }
                }
            },
            error: function (err) {
                if (failcallback != null) {
                    failcallback(JSON.stringify(err));
                }
            },
            complete: function () {
                if (showLoading) {
                    ddHideLoading();
                }
            }
        })
    }
    
    
    function urlEncoder(content) {
        return content.replace(/[#]/g,"%23");
    }

    // 响应转流
    function convertRes2Blob(xhr, defaultFileName) {
        let fileName = defaultFileName
        // 提取文件名
        const contentDisposition = xhr.getResponseHeader('Content-Disposition');
        if (contentDisposition) {
            if (contentDisposition.includes('filename')) {
                fileName = contentDisposition.match(/filename=(.*)/)[1]
            }
        }
        // 将二进制流转为blob
        const blob = xhr.response
        if (typeof window.navigator.msSaveBlob !== 'undefined') {
            // 兼容IE，window.navigator.msSaveBlob：以本地方式保存文件
            window.navigator.msSaveBlob(blob, decodeURI(fileName))
        } else {
            // 创建新的URL并指向File对象或者Blob对象的地址
            const blobURL = URL.createObjectURL(blob)
            // 创建a标签，用于跳转至下载链接
            const tempLink = document.createElement('a')
            tempLink.style.display = 'none'
            tempLink.href = blobURL
            tempLink.setAttribute('download', decodeURI(fileName))
            // 兼容：某些浏览器不支持HTML5的download属性
            if (typeof tempLink.download === 'undefined') {
                tempLink.setAttribute('target', '_blank')
            }
            // 挂载a标签
            document.body.appendChild(tempLink)
            tempLink.click()
            document.body.removeChild(tempLink)
            // 释放blob URL地址
            window.URL.revokeObjectURL(blobURL)
        }
    }

    // 自动缩放页面
    function adjustPageScale() {
        const designWidth = 1200;
        const currentWidth = window.innerWidth;

        if (currentWidth < designWidth) {
            document.documentElement.style.zoom = currentWidth / designWidth;
            // 或者使用 transform scale
            document.documentElement.style.transform = 'scale(' + currentWidth + '/' + designWidth + ')';
            document.documentElement.style.transformOrigin = 'top left';
            document.documentElement.style.overflowX = 'hidden'; // 防止水平滚动条出现
        } else {
            document.documentElement.style.zoom = '';
            document.documentElement.style.transform = '';
            document.documentElement.style.overflowX = '';
        }
    }

    // 监听窗口大小变化
    window.addEventListener('resize', adjustPageScale);

    // 页面加载时也调用一次
    adjustPageScale();
</script>

		<link rel="stylesheet" type="text/css" href="/static/css/jquery-ui.css">
		<script src="/static/js/jquery-ui.js"></script>
	</head>
	<body style="background: #f4f4f4;">
		
















<script type="text/javascript" src="/static/js/marked.min.js"></script>

<link rel="preload" href="bold.woff2" as="font" type="font/woff2" crossorigin="">
<link rel="stylesheet" type="text/css" href="/static/css/modelAi.css?v=1.0.0">

<div class="j-model-ai">
    <div class="ai-chat-container">
        <div class="chat-box" id="chat-box">
            <!-- 聊天消息会动态插入到这里 -->
        </div>
        <div class="input-container">
            <textarea type="text" id="user-input" placeholder="输入你的问题..." maxlength="100" autocomplete="off" name="aiInput"></textarea>
            <span id="char-count">0/100</span>
            <button id="send-btn">发送</button>
        </div>
    </div>
</div>

<script>
    const chatBox = $('#chat-box');
    const userInput = $('#user-input');
    const sendBtn = $('#send-btn');
    const markdownPattern = /(\*\*|__|\*|_|~~|`|``|!$|\[|$\(|\[)/;
    let chipModelId = '';
    let isStreamEnded = false;
    let chipHref = "";
    let isMessageBeingSent = false;
    let keywords = [];
    let queue = [];
    let isProcessing = false;

    // 新增状态变量
    let accumulatedContent = '';  // 累积的内容
    let accumulatedReasoningContent = '';  // 累积的内容
    let currentMessageContainer = null; // 当前消息容器

    // 滚动状态控制变量
    let isUserIntervened = false;
    let lastScrollHeight = 0;
    let scrollScheduled = false;

    let currentXhr = null;

    // 增强的滚动控制器
    function enforceScroll() {
        const chatEl = chatBox[0];
        const now = Date.now();

        // 计算需要滚动的距离
        const targetScrollTop = chatEl.scrollHeight;
        const currentPos = chatEl.scrollTop + chatEl.clientHeight;
        const scrollThreshold = 50; // 滚动敏感度阈值

        // 只有需要滚动超过阈值时才执行
        if (targetScrollTop - currentPos > scrollThreshold && !isUserIntervened) {
            // 使用即时滚动代替平滑滚动
            chatEl.scrollTop = targetScrollTop;

            // 强制同步布局更新
            void chatEl.offsetHeight; // 触发重绘
        }

        lastScrollHeight = chatEl.scrollHeight;
        scrollScheduled = false;
    }

    // 优化的滚动监听
    chatBox.on('scroll', () => {
        const chatEl = chatBox[0];
        const currentPos = chatEl.scrollTop + chatEl.clientHeight;

        // 判断用户是否干预（保留20px的缓冲区）
        isUserIntervened = currentPos < chatEl.scrollHeight - 20;
    });

    document.getElementById('user-input').addEventListener('input', function () {
        const charCount = this.value.length;
        document.getElementById('char-count').textContent = charCount + '/100';
    });

    function initMessage(model) {
        let welcomeMessage = "";
        welcomeMessage += '<div class="message system">'
        welcomeMessage += '     <div class="avatar"><img style="width:30px;height:30px" src="/static/img/semiee-icon.png"/></div>'
        welcomeMessage += '     <div class="message-content">'
        welcomeMessage += '         <div class="prompt-message">'
        // welcomeMessage += '             秒回行情动态，速解规格参数！<br>'
        // welcomeMessage += '             半导AI“芯易通”为您服务～<br>'
        welcomeMessage += '             我是半导小芯AI助手，如果你有关于' + model + '的问题，请随时告诉我，我会尽我所能提供解答。<br>'
        welcomeMessage += '             <div class="remark">注：AI智能回复，仅供参考，建议决策时进行多方信息验证。</div>'
        welcomeMessage += '         </div>'
        welcomeMessage += '         <div class="keyword-options">'
        keywords.forEach(keyword => {
            welcomeMessage += '             <div>'
            welcomeMessage += '                 <div class="keyword-option" data-id=' + keyword.templateId + '>' + keyword.title + '</div>'
            welcomeMessage += '             </div>'
        })
        welcomeMessage += '         </div>'
        welcomeMessage += '     </div>'
        welcomeMessage += '</div>';
        chatBox.append(welcomeMessage);

        $('.keyword-option').click(function () {
            const keyword = $(this).text();
            const templateId = $(this).data("id");
            userInput.val(keyword);
            sendMessage(templateId);
        });

        chatBox[0].scrollTo({
            top: chatBox[0].scrollHeight,
            behavior: 'smooth'
        });
    }

    function initWelcomeMessage(chipId, model, href) {
        chipHref = href;
        ddGet("/chip/ask/" + chipId + "/records", {}, function (dd) {
            chatBox.html("");
            let result = dd.result;
            for (let r in result) {
                let question = result[r].question;
                let answer = result[r].answer;
                let reasoning = result[r].reasoning;
                if (answer) {
                    appendMessage('user', question);
                    appendMessage('system', answer, reasoning);
                }
            }
            initMessage(model);
        }, function (msg) {
        }, false);

        if (chipModelId !== chipId) {
            chipModelId = chipId;
            chatBox.html("");
            initMessage(model);
        }
    }

    function sendMessage(templateId) {
        if (isMessageBeingSent) {
            $("#failNotification").html('<img src="/static/img/fail-icon.png" alt="" class="success-icon"> 正在处理中，请稍后...').fadeIn().delay(3000).fadeOut('slow', function () {
                $("#failNotification").hide();
            });
            return;
        }

        const message = userInput.val().trim();
        if (message) {
            isMessageBeingSent = true;
            // sendBtn.prop('disabled', true);
            sendBtn.text('停止');

            appendMessage('user', message);
            userInput.val('');
            document.getElementById('char-count').textContent = '0/100';

            // 重置所有状态
            accumulatedContent = '';
            accumulatedReasoningContent = '';
            currentMessageContainer = null;
            isStreamEnded = false;

            callBackend(templateId, message);
        }
    }

    function createSystemMessageContainer(hasReasoning) {
        let systemMessage = '<div class="message system">';

        systemMessage += '<div class="avatar"><img style="width:30px;height:30px" src="/static/img/semiee-icon.png"/></div>';

        systemMessage += '<div class="message-content">';

        if (hasReasoning) {
            systemMessage += `
            <div class="reasoning-header">
                <span>已深度思考</span>
                <div class="arrow-icon expanded"></div>
            </div>
            <div class="reasoning-content" style="display: block;"></div>`;
        }

        systemMessage += '<div class="content"></div></div></div>';

        // 将字符串转换为jQuery对象
        const $systemMessage = $(systemMessage);

        // 绑定折叠按钮的点击事件
        if (hasReasoning) {
            $systemMessage.find('.arrow-icon').click(function () {
                const reasoningContent = $systemMessage.find('.reasoning-content');
                const arrowIcon = $(this);

                if (reasoningContent.is(':visible')) {
                    reasoningContent.hide();
                    arrowIcon.removeClass('expanded'); // 移除展开状态
                } else {
                    reasoningContent.show();
                    arrowIcon.addClass('expanded'); // 添加展开状态
                }
            });
        }

        // 追加到chatBox中
        chatBox.append($systemMessage);
        chatBox.scrollTop(chatBox[0].scrollHeight);

        // 返回.message-content部分
        return $systemMessage.find('.message-content');
    }

    function appendMessage(sender, message, reasoning) {
        let avatarHtml = '';
        if (sender === 'system') {
            avatarHtml = '<div class="avatar"><img style="width:30px;height:30px" src="/static/img/semiee-icon.png"/></div>'; // 对于系统消息，添加头像
        }

        // 判断是否是 Markdown
        const isMarkdown = markdownPattern.test(message);
        let htmlContent;
        if (isMarkdown) {
            htmlContent = marked.parse(message); // 如果是 Markdown，转换为 HTML
        } else {
            htmlContent = $('<div>').text(message).html(); // 否则，直接插入文本并转义特殊字符
        }

        let messageElement = '';
        messageElement += '<div class="message ' + sender + '">';
        messageElement += avatarHtml;
        messageElement += '<div class="message-content">';

        // 如果 reasoning 不为空，添加“已深度思考”和 reasoning-content
        if (reasoning) {
            messageElement += '<div class="reasoning-header">'
            messageElement += '<span>已深度思考</span>'
            messageElement += '<div class="arrow-icon"></div>'
            messageElement += '</div>'
            messageElement += '<div class="reasoning-content markdown-body" style="display: none;">' + marked.parse(reasoning) + '</div>'
        }

        messageElement += '<div class="content">' + htmlContent + '</div>'

        messageElement += '</div></div>';
        chatBox.append(messageElement);
        chatBox.scrollTop(chatBox[0].scrollHeight);

        // 绑定箭头点击事件
        if (reasoning) {
            const reasoningHeader = chatBox.find('.reasoning-header').last();
            const reasoningContent = chatBox.find('.reasoning-content').last();
            const arrowIcon = reasoningHeader.find('.arrow-icon');

            reasoningHeader.click(function () {
                if (reasoningContent.is(':visible')) {
                    reasoningContent.hide();
                    arrowIcon.removeClass('expanded'); // 移除展开状态
                } else {
                    reasoningContent.show();
                    arrowIcon.addClass('expanded'); // 添加展开状态
                }
            });
        }
    }

    function processNewData(newData) {
        const lines = newData.split('\n\n');
        for (let i = 0; i < lines.length; i++) {
            if (lines[i].startsWith('data:')) {
                const jsonData = lines[i].substring(5).trim();
                if (jsonData) {
                    if (jsonData.trim() !== '[DONE]') {
                        try {
                            const chunk = JSON.parse(jsonData);
                            for (let j = 0; j < chunk.choices.length; j++) {
                                const delta = chunk.choices[j].delta || {};
                                if (delta.reasoning_content !== undefined) {
                                    if (delta.reasoning_content !== null) {
                                        queue.push({
                                            type: 'reasoning',
                                            content: delta.reasoning_content
                                        });
                                    }
                                }
                                if (delta.content) {
                                    queue.push({
                                        type: 'content',
                                        content: delta.content
                                    });
                                }
                            }
                        } catch (parseError) {
                            console.error("Error parsing JSON data:", parseError);
                        }
                    }
                }
            } else if (lines[i].trim() === '[DONE]') {
                isStreamEnded = true;
                console.log('Stream ended.');
            }
        }

        if (!isProcessing) {
            processQueue();
        }
    }

    function processQueue() {
        if (queue.length === 0) {
            Promise.resolve().then(() => {
                if (scrollScheduled) return;

                scrollScheduled = true;
                requestAnimationFrame(enforceScroll);
            });

            // 针对大内容更新的优化
            const heightDiff = chatBox[0].scrollHeight - lastScrollHeight;
            if (heightDiff > 500) { // 大内容块特殊处理
                cancelAnimationFrame(scrollScheduled);
                enforceScroll();
            }

            isProcessing = false;
            return;
        }

        isProcessing = true;
        const data = queue.shift();

        if (data.content) {
            if (data.type === 'reasoning') {
                handleResponse(data.content, true, true);
            } else {
                handleResponse(data.content, true, false);
            }
        }

        // setTimeout(() => {
            processQueue();
        // }, 10);
    }

    function handleResponse(responseText, isStream, isReasoning) {
        if (isStreamEnded) return;

        if (!currentMessageContainer) {
            currentMessageContainer = createSystemMessageContainer(isReasoning);
            currentMessageContainer.find(".reasoning-content").show();
            currentMessageContainer.find('.arrow-icon').addClass('expanded');
        }

        if (isReasoning) {
            // 如果是思考过程，统一追加到 reasoning-content 容器中
            const reasoningContainer = currentMessageContainer.find('.reasoning-content');
            if (reasoningContainer.length === 0) {
                // 如果容器不存在，创建一个
                currentMessageContainer.prepend('<div class="reasoning-content"></div>');
            }
            accumulatedReasoningContent += responseText;

            // 判断是否为 Markdown 格式
            const isMarkdown = markdownPattern.test(accumulatedReasoningContent);
            let htmlContent;
            if (isMarkdown) {
                // 如果是 Markdown，使用 marked.js 解析
                htmlContent = marked.parse(accumulatedReasoningContent);
            } else {
                // 如果是纯文本，将换行符替换为 <br>
                htmlContent = accumulatedReasoningContent.replace(/\n/g, '<br>');
            }
            reasoningContainer.html(htmlContent);

        } else {
            // 如果是正式内容，追加到 content 容器中
            accumulatedContent += responseText;
            const isMarkdown = markdownPattern.test(accumulatedContent);
            const htmlContent = isMarkdown ? marked.parse(accumulatedContent) : $('<div>').text(accumulatedContent).html();
            currentMessageContainer.find('.content').html(htmlContent); // 将内容放入 content 容器
        }

        // 使用微任务进行滚动调度
        Promise.resolve().then(() => {
            if (scrollScheduled) return;

            scrollScheduled = true;
            requestAnimationFrame(enforceScroll);
        });

        // 针对大内容更新的优化
        const heightDiff = chatBox[0].scrollHeight - lastScrollHeight;
        if (heightDiff > 500) { // 大内容块特殊处理
            cancelAnimationFrame(scrollScheduled);
            enforceScroll();
        }
    }

    function callBackend(templateId, message) {
        const deviceId = getDeviceId();
        const token = getToken();
        const loadingMessageContent = createSystemMessageContainer();
        loadingMessageContent.html('<div id="loading-spinner"></div>');

        const xhr = new XMLHttpRequest();
        currentXhr = xhr;
        xhr.open('POST', host + '/chip/ask/' + chipModelId + '/siliconflow/conversation', true);
        xhr.setRequestHeader('deviceId', deviceId);
        xhr.setRequestHeader('token', token);
        xhr.setRequestHeader('source', 1);
        xhr.setRequestHeader('os', 2);
        xhr.setRequestHeader('Content-Type', 'application/json');

        xhr.onreadystatechange = function () {
            if (xhr.readyState === XMLHttpRequest.DONE) {
                currentXhr = null;
                loadingMessageContent.parent().remove();
                isMessageBeingSent = false;
                // sendBtn.prop('disabled', false);
                sendBtn.text('发送');

                if (currentMessageContainer) {
                    currentMessageContainer.find(".reasoning-content").hide();
                    currentMessageContainer.find('.arrow-icon').removeClass('expanded'); // 更新箭头方向
                }
            }
        };

        xhr.onabort = function() {
            queue = [];
            currentXhr = null;
            isMessageBeingSent = false;
            sendBtn.text('发送');
            $('.message.system .message-content').filter(function() {
                return $(this).find('#loading-spinner').length > 0;
            }).parent().remove();
        };

        let currentLength = 0;

        xhr.onprogress = function () {
            const responseText = xhr.responseText;
            const newData = responseText.substring(currentLength);
            currentLength = responseText.length;
            if (newData) {
                loadingMessageContent.parent().remove();
                processNewData(newData);
            }
        };

        xhr.onerror = function () {
            console.error("Network error occurred");
            handleResponse("服务器繁忙，请稍后再试", false);
        };

        xhr.onloadend = function () {
            loadingMessageContent.parent().remove();
            isMessageBeingSent = false;
            sendBtn.prop('disabled', false);

            if (currentMessageContainer) {
                currentMessageContainer.find(".reasoning-content").hide();
                currentMessageContainer.find('.arrow-icon').removeClass('expanded'); // 更新箭头方向
            }
        };

        xhr.send(JSON.stringify({templateId: templateId, contents: message, url: chipHref}));
    }

    sendBtn.click(function () {
        if ($(this).text() === '停止') {
            if (currentXhr) {
                currentXhr.abort();
                currentXhr = null;
            }
            isMessageBeingSent = false;
            sendBtn.text('发送');
            queue = [];
            $('.message.system .message-content').filter(function() {
                return $(this).find('#loading-spinner').length > 0;
            }).parent().remove();
        } else {
            sendMessage(null);
        }
    });

    document.getElementById('user-input').addEventListener('keypress', function (e) {
        if (e.which === 13) {
            e.preventDefault();
            sendMessage(null);
        }
    });

    function initTemplate() {
        ddGet("/chip/ask/templates", {}, dd => keywords = [...dd.result], () => {
        }, false);
    }

    initTemplate();
</script>











<style>
    .sample-apply-container {
        background-color: #FFFFFF;
        overflow: hidden;
        width: 100vw;
        height: 100vh;
        max-width: 400px;
        max-height: 480px;
        min-width: 300px;
        min-height: 400px;

        box-sizing: border-box;
        overflow-x: hidden;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        resize: both;
        padding: 0 20px;
    }

    .sample-apply-container .Encyclopedia-one {
        font-size: 20px;
        text-align: center;
        color: #3366CC;
        line-height: 74px;
    }

    .layui-form {
        width: 100%;
    }

    .apply-form {
        border: 1px solid #E3E3E3;
        border-radius: 4px;
        overflow: hidden;
    }

    .layui-form-item {
        display: flex;
        align-items: center;

        padding: 10px 20px;
        line-height: 24px;
        font-size: 14px;
        color: #5D5D5D;
        border-bottom: 1px solid #e3e3e3;
    }

    .layui-form-label {
        text-align: left;
        width: 100px;
        margin-bottom: 0 !important;
    }

    .btn-primary {
        width: 100%;
        line-height: 24px;
    }

    .step {
        display: none;
    }

    .step.active {
        display: block;
    }

    .layui-input-block-next {
        padding-top: 137px;
    }

    .layui-input-block {
        padding-top: 30px;
    }

    .layui-form-item input {
        border: none;
        outline: none;
        padding: 2px 6px;
        width: calc(100% - 110px);
    }

    .btn-back {
        margin-bottom: 20px;
        background: #fff;
        color: #3366CC;
    }

</style>

<div class="j-sample-apply" style="display: none;">
    <div class="sample-apply-container">
        <!-- 步骤1 -->
        <div class="step active" data-step="1">
            <p class="Encyclopedia-one">—— 需求信息 ——</p>
            <form id="demandForm" class="layui-form">
                <div class="apply-form">
                    <div class="layui-form-item">
                        <label class="layui-form-label"><span style="color: red;">*</span>样品型号：</label>
                        <input type="text" name="sample_model" id="sampleModel" readonly="" class="layui-input layui-disabled">
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label"><span style="color: red;">*</span>样品数量(片)：</label>
                        <input type="number" name="num" data-field="样品数量" min="1" required="" class="layui-input" placeholder="请输入样品数量">
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label"><span style="color: red;">*</span>终端产品：</label>
                        <input type="text" name="terminal_product" data-field="终端产品" required="" class="layui-input" placeholder="请输入终端产品">
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label"><span style="color: red;">*</span>年用量(千片)：</label>
                        <input type="number" name="year_use_num" data-field="年用量" min="1" required="" class="layui-input" placeholder="请输入年用量">
                    </div>
                </div>
                <div class="layui-input-block-next">
                    <button type="button" class="btn btn-primary" onclick="nextStep()">下一步
                    </button>
                </div>
            </form>
        </div>

        <!-- 步骤2 -->
        <div class="step" data-step="2">
            <p class="Encyclopedia-one">—— 基本信息 ——</p>
            <form id="basicInfoForm" class="layui-form">
                <div class="apply-form">
                    <div class="layui-form-item">
                        <label class="layui-form-label"><span style="color: red;">*</span>您的姓名：</label>
                        <input type="text" name="user_name" data-field="姓名" required="" class="layui-input" placeholder="请填写姓名">
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label"><span style="color: red;">*</span>公司名称：</label>
                        <input type="text" name="company_name" data-field="公司名称" placeholder="请填写完整的公司名称" required="" class="layui-input">
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label"><span style="color: red;">*</span>联系电话：</label>
                        <input type="tel" name="link_phone" data-field="联系电话" required="" class="layui-input" placeholder="请填写联系电话">
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label"><span style="color: red;">*</span>联系邮箱：</label>
                        <input type="email" name="email" data-field="联系邮箱" placeholder="请使用公司或学校邮箱" required="" class="layui-input">
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label"><span style="color: red;">*</span>收件地址：</label>
                        <input type="text" name="address" data-field="收件地址" required="" class="layui-input" placeholder="请填写收件地址">
                    </div>
                </div>
                <div class="layui-input-block">
                    <button type="button" class="btn btn-primary btn-back" onclick="prevStep()">上一步
                    </button>
                    <button type="button" class="btn btn-primary" onclick="submitForm()">提交申请
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    let currentStep = 1;
    let chipId;
    let formData = {};

    function nextStep() {
        // 验证步骤1数据
        let valid = true;
        $('[data-step="1"] input').each(function () {
            const $input = $(this);
            if ($input.prop('readonly')) return;
            if (!$input.val().trim()) {
                layer.msg('请填写' + $input.attr('data-field'));
                valid = false;
                return false;
            }
        });

        if (valid) {
            // 收集步骤1数据
            $('[data-step="1"] input').each(function () {
                formData[$(this).attr('name')] = $(this).val();
            });

            currentStep = 2;
            $('.step').removeClass('active');
            $('[data-step="2"]').addClass('active');

            // 检查缓存并填充步骤2表单
            const cachedData = getCache('sampleApplyBaseInfo');
            if (cachedData) {
                fillFormWithData($('[data-step="2"]'), cachedData);
            }

            var vo = {};
            vo.type = 124;
            vo.chipId = chipId;
            vo.source = 1;
            vo.os = 2;
            ddPost("/operatorlog/upload", vo, function (dd) {
            }, function (msg) {
            }, true);
        }
    }

    function prevStep() {
        currentStep = 1;
        $('.step').removeClass('active');
        $('[data-step="1"]').addClass('active');
    }

    function submitForm() {
        // 验证步骤2数据
        let valid = true;
        $('[data-step="2"] input').each(function () {
            const $input = $(this);
            if (!$input.val().trim()) {
                layer.msg('请填写' + $input.attr('data-field'));
                valid = false;
                return false;
            }
        });

        // 邮箱验证
        const email = $('[name="email"]').val();
        if (email.indexOf('@') === -1 || email.indexOf('.com') === -1) {
            layer.msg('邮箱需要包含 @ 和 .com 后缀');
            return;
        }

        if (valid) {
            const step2FormData = {};
            // 收集步骤2数据
            $('[data-step="2"] input').each(function () {
                formData[$(this).attr('name')] = $(this).val();
                step2FormData[$(this).attr('name')] = $(this).val();
            });

            var vo = {};
            vo.type = 125;
            vo.chipId = chipId;
            vo.source = 1;
            vo.os = 2;
            ddPost("/operatorlog/upload", vo, function (dd) {
            }, function (msg) {
            }, true);

            ddPost('/chip/' + chipId + '/sampleApply', formData, function (dd) {
                let code = dd.code;
                if (code === 0) {
                    layer.closeAll();
                    layer.msg('提交成功');
                    // 将步骤2的数据存储到缓存中
                    setCache('sampleApplyBaseInfo', step2FormData);
                }
            }, function (msg) {
                if (msg === "未登录") {
                    layer.closeAll();
                    openLogin();
                } else {
                    layer.msg('提交失败，请重试');
                }
            })
        }
    }

    function initSampleApply(id, model) {
        // 清空表单信息
        $('#demandForm')[0].reset();
        $('#basicInfoForm')[0].reset();

        // 切换到第一步
        $('.step').removeClass('active');
        $('.step[data-step="1"]').addClass('active');

        chipId = id;
        $('#sampleModel').val(model);
    }

    // 缓存相关函数
    function setCache(key, data) {
        localStorage.setItem(key, JSON.stringify(data));
    }

    function getCache(key) {
        const cachedData = localStorage.getItem(key);
        return cachedData ? JSON.parse(cachedData) : null;
    }

    function fillFormWithData($form, data) {
        $form.find('input').each(function () {
            const name = $(this).attr('name');
            if (data[name]) {
                $(this).val(data[name]);
            }
        });
    }
</script>

<script type="text/javascript" src="/static/qrcodejs/qrcode.js"></script>
<style type="text/css">
    .top-news .top-newsone:first-child{
        background: none;
        border: none;
        border-radius: 4px 4px 0 0;
    }
    .top-news .top-newsone.message{
        color: #000000;
    }
    .top-news .tel:hover {
        color: #3366cc;
        background: #f4f4f4;
    }
    .top-news .tel:hover .frist-li{
        border-radius: 4px 4px 0 0;
    }
    .top-news li .slide-news li{
        display: block;
        color: #737373;
    }
    .top-news li .slide-news li:hover{
        color: #3366cc;
    }

    .eeService {
        margin-left: 10px;
        width: 120px;
        position: relative;
        cursor: pointer;
        display: inline-block;
        line-height: 38px;
        font-size: 13px;
    }

    .eeService .frist-li {
        width: 120px;
        text-align: center;
    }

    .eeService .enterpriseService {
        font-size: 14px;
    }

    .eeService:hover {
        color: #3366cc;
        background: #f4f4f4;
        border-radius: 4px 4px 0 0;
    }

    .eeService:hover .frist-li {
        background: #f4f4f4;
        border-radius: 4px 4px 0 0;
    }

    .top-newsone .ee-service-item {
        position: absolute;
        left: 0;
        width: 120px;
        border: 1px solid #e3e3e3;
        border-radius: 0 0 4px 4px;
        overflow: hidden;
        text-align: center;
        background: #fff;
        z-index: 999;
    }

    .top-newsone .ee-service-item li:hover {
        color: #3366cc;
        background: #f4f4f4;
    }

    .top-newsone .ee-service-item li a:hover {
        text-decoration: none;
    }
</style>

<!--搜索-->
<div class="personal">
    <div class="top">
        <div class="top-content" style="width: 1200px">
            <div class="top-logo"><a href="/"><img src="/static/img/logo-2.png"></a></div>
            <div class="top-serch">
                <!-- 隐藏的假字段,防止密码框弹出 -->
                <input type="text" style="display:none" name="fakeUsername">
                <input type="password" style="display:none" name="fakePassword">
                <input id="searchModel" type="text" name="searchModel" value="" placeholder="请输入型号/品牌/分类/丝印" autocomplete="off">
                <span class="closeText" id="clear"><img src="/static/img/close.png"></span>
                <span class="cearch-botton" id="search">查询一下</span>
                <div class="hostory" style="display: none;">
                    <div class="hostory-his-search">
                        <span class="closeHistory" id="hostory-his-search-clear"><img src="/static/img/close.png"></span>
                        <p>历史记录</p>
                        <div class="hostory-his-search-div"></div>
                    </div>
                    <div class="hostory-hots-search">
                        <p>热门搜索</p>
                        <div class="hostory-hot-search-div"></div>
                    </div>
				</div>
                <div class="associate"></div>
            </div>
            <ul id="notLoginBox" class="search-tab" style="display: none;padding-right: 120px">
                <li class="top-newsone eeService">
                    <div class="frist-li">
                        <span class="enterpriseService">企业服务</span>
                        <span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
                    </div>
                    <ul class="ee-service-item" style="display: none;">
                        <li style="width: 100%;margin-left: 0;">
                            <a href="/api-portal" style="color: #737373;font-size: 14px;">API套件</a>
                        </li>
                    </ul>
                </li>
                <li><a href="javascript:void(0);" class="jsLoginPage">登录</a></li>
            </ul>
            <div class="top-news" id="alrLoginBox" style="float: left; padding-left: 20px !important;">
                <li class="top-newsone" style="width: unset !important;margin-left:0 !important;">
                    <div class="bom-upload-container">
                        <span class="bom-upload">BOM上传</span>
                        








<link rel="stylesheet" type="text/css" href="/static/css/bomUpload.css?v=1.0.0">

<div class="j-bom-upload" style="display: none;">
    <div class="form-container">
        <form id="uploadForm" enctype="multipart/form-data">

            <div class="form-group">
                <label for="bomData">BOM文件</label>
                <label class="upload-area" id="uploadArea" for="bomData">
                    将BOM文件拖到此处，或点击上传
                    <input type="file" id="bomData" name="bomData" accept=".xls,.xlsx">
                </label>
                <div class="file-list" id="fileList"></div>
                <div class="error" id="chipError"></div>

                <!-- 下载模板 -->
                <div class="el-upload__tip text-left">
                    <span>支持上传 xls、xlsx 格式文件；最大文件不超过10M</span>
                    <a href="javascript:void(0);" id="downloadTemplate">下载模板</a>
                </div>
            </div>

            <div class="form-group btn-group">
                <button type="submit" class="btn btn-submit" id="submitBtn">提交</button>
                <button type="button" class="btn btn-default" id="resetBtn">重置</button>
            </div>

        </form>
    </div>
</div>

<script>
    let selectedFile = null;
    const maxSize = 10 * 1024 * 1024;
    // 上传成功跳转确认框
    let uploadSuccess
    // 上传成功跳转倒计时（秒）
    let uploadCountdown = 5;
    // 上传跳转计时器
    let uploadTimer;

    function handleFile(file) {
        if (!file) return;

        const allowedTypes = ['application/vnd.ms-excel', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'];
        if (!allowedTypes.includes(file.type)) {
            $("#failNotification").html('<img src="/static/img/fail-icon.png" alt="" class="success-icon"> 请上传 Excel 文件 (.xls 或 .xlsx)').fadeIn().delay(3000).fadeOut('slow', function () {
                $("#failNotification").hide();
            });
            return;
        }

        if (file.size > maxSize) {
            $("#failNotification").html('<img src="/static/img/fail-icon.png" alt="" class="success-icon"> 文件大小不能超过10MB').fadeIn().delay(3000).fadeOut('slow', function () {
                $("#failNotification").hide();
            });
            return;
        }

        selectedFile = file;
        addFileToList(file);
        $('#chipError').text('');
    }

    function addFileToList(file) {
        const $fileItem = $('<div class="file-item"></div>');
        const $fileName = $('<span class="file-name">' + file.name + '</span>');
        const $deleteBtn = $('<span class="delete-btn">删除</span>');

        $deleteBtn.on('click', function () {
            $fileItem.remove();
            selectedFile = null;
            $('#chipError').text('');
        });

        $fileItem.append($fileName).append($deleteBtn);
        $('#fileList').html($fileItem); // 清除并添加新的文件项
    }

    // 替代型号导出
    function downTemplate() {
        ddShowLoading();
        var xhr = new XMLHttpRequest();
        xhr.open('post', host + '/bom/template', true);
        xhr.setRequestHeader("deviceId", getDeviceId())
        xhr.setRequestHeader("token", getToken())
        xhr.setRequestHeader("source", 1)
        xhr.setRequestHeader("os", 2)
        //设置ajax的响应类型为blob 就是不管服务端返回的是啥 都用流的形式来接了
        xhr.responseType = 'blob';
        xhr.onload = function () {
            ddHideLoading();
            //这里的this是整个response对象 包括流数据，包括响应头等
            var xhr = this;
            const resonseType = xhr.getResponseHeader('Content-Type');
            ////流文件的处理
            if (resonseType.includes('application/octet-stream')) {
                //流转成文件 convertRes2Blob函数
                convertRes2Blob(xhr, '半导小芯-BOM上传模板.xlsx')
            } else { //文本的处理
                //将流读出来
                var reader = new FileReader();
                reader.onload = function (event) {
                    //普通json数据
                    var content = reader.result;
                    //注意这个content是json字符串，如果需要获取对象里的属性等需要parse一下
                    var res = JSON.parse(content);
                    if (res.success) {
                        layer.alert(res.message || '下载成功');
                    } else {
                        if (res.message === "请登录") {
                            openLogin();
                        } else {
                            layer.alert(res.message || '下载失败');
                        }
                    }
                };
                reader.readAsText(xhr.response);
            }
        };
        xhr.send();
    }

    function uploadSuccessRedirect(id) {
        if (!uploadSuccess) {
            uploadSuccess = layer.confirm('上传成功，将在' + uploadCountdown + '秒后自动跳转结果页面', {
                closeBtn: false,
                btn: ['立即跳转（' + uploadCountdown + '）'],
                success: function (layerElem) {  // 弹窗渲染完成回调
                    // 获取确认按钮（通过layer索引）
                    var confirmBtn = $(layerElem).find('.layui-layer-btn0');

                    // 启动倒计时
                    uploadTimer = setInterval(function () {
                        uploadCountdown--;
                        confirmBtn.text('立即跳转（' + uploadCountdown + '）');

                        if (uploadCountdown <= 0) {
                            clearInterval(uploadTimer);
                            layer.close(uploadSuccess);  // 关闭当前弹窗
                            window.location.href = ctx + '/bom/' + id + '.html';
                        }
                    }, 1000);

                    // 手动点击清除定时器
                    confirmBtn.on('click', function () {
                        clearInterval(uploadTimer);
                    });
                }
            }, function (index) {  // 确认按钮回调
                layer.closeAll();
                window.location.href = ctx + '/bom/' + id + '.html';
            });
        }
    }

    $(function () {

        // 模拟 el-switch 开关
        $('#backSpaceSwitch').on('click', function () {
            $(this).toggleClass('checked');
            $('#backSpaceValue').val($(this).hasClass('checked'));
        });

        // 点击上传
        $('#bomData').on('click', function (e) {
            e.stopPropagation(); // 阻止事件冒泡
            if (selectedFile) {
                $("#failNotification").html('<img src="/static/img/fail-icon.png" alt="" class="success-icon"> 您已经上传了一个文件，不能上传更多文件。').fadeIn().delay(3000).fadeOut('slow', function () {
                    $("#failNotification").hide();
                });
                e.preventDefault();
            }
        });

        // 文件选择变化
        $('#bomData').on('change', function (e) {
            const file = this.files[0];
            handleFile(file);
            // 清空输入框以便重复选择同一文件
            this.value = '';
        });

        // 拖拽上传逻辑
        const uploadArea = $('#uploadArea');

        uploadArea
            .on('dragover', function (e) {
                e.preventDefault();
                if (!selectedFile) $(this).css('border-color', '#409EFF');
            })
            .on('dragleave', function (e) {
                $(this).css('border-color', '#ccc');
            })
            .on('drop', function (e) {
                e.preventDefault();
                $(this).css('border-color', '#ccc');
                if (!selectedFile) {
                    const files = e.originalEvent.dataTransfer.files;
                    handleFile(files[0]);
                } else {
                    $("#failNotification").html('<img src="/static/img/fail-icon.png" alt="" class="success-icon"> 您已经上传了一个文件，不能上传更多文件。').fadeIn().delay(3000).fadeOut('slow', function () {
                        $("#failNotification").hide();
                    });
                }
            });


        // 表单提交
        $('#uploadForm').on('submit', function (e) {
            e.preventDefault();

            if (!selectedFile) {
                $('#chipError').text('请选择一个文件');
                return false;
            }

            const formData = new FormData();
            formData.append('bomData', selectedFile);

            // 模拟 loading
            const $submitBtn = $('#submitBtn');
            $submitBtn.prop('disabled', true);

            ddUpload('/bom/upload', formData, function (dd) {
                let code = dd.code;
                if (code === 0) {
                    uploadSuccessRedirect(dd.result);
                    $submitBtn.prop('disabled', false);
                    $('#resetBtn').click();
                    $(".j-bom-upload").hide();
                }
            }, function (msg) {
                $submitBtn.prop('disabled', false);
                $('#resetBtn').click();
                if (msg === "请登录") {
                    openLogin();
                } else if (msg === "已达今天浏览限制次数") {
                    layer.open({
                        type: 1,
                        title: false,
                        closeBtn: 1,
                        area: ['360px', '379px'],
                        skin: 'layui-layer-nobg', //没有背景色
                        shadeClose: false,
                        content: $('.once-msg')
                    });
                } else {
                    layer.alert(msg || '上传失败');
                }
            }, true)
        });

        // 重置表单
        $('#resetBtn').on('click', function () {
            $('#uploadForm')[0].reset();
            selectedFile = null;
            $('#fileList').empty();
            $('#backSpaceSwitch').removeClass('checked');
            $('#backSpaceValue').val('false');
            $('#chipError').text('');
        });

        // 下载模板功能
        $('#downloadTemplate').on('click', function () {
            downTemplate();
        });


    });
</script>

                    </div>
                </li>
                <li class="top-newsone eeService" style="margin-left: 5px;">
                    <div class="frist-li">
                        <span class="enterpriseService">企业服务</span>
                        <span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
                    </div>
                    <ul class="ee-service-item" style="display: none;">
                        <li style="width: 100%;margin-left: 0;">
                            <a href="/api-portal" style="color: #737373;font-size: 14px;">API套件</a>
                        </li>
                    </ul>
                </li>
                <li class="top-newsone tel" style="width: 120px">
                    <div class="frist-li" style="text-align: center;">
                        <span id="userPhoneNumber">157****2034</span>
                        <span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
                    </div>
                    <ul class="slide-news" style="display: none;">
                        <li class="js_self_nav_bar" data-type="1">我的消息</li>
                        <li class="js_self_nav_bar" data-type="2">我的收藏</li>
                        <li class="js_self_nav_bar" data-type="3">最近浏览</li>
                        <li class="js_self_nav_bar" data-type="4">绑定邮箱</li>
                        <li class="js_self_nav_bar" data-type="5">我的品牌</li>
                        <li class="js_self_nav_bar" data-type="bom">我的BOM</li>
                        <li class="js_self_nav_bar" data-type="6">退出登录</li>
                    </ul>
                </li>
            </div>
        </div>
    </div>
</div>

<!--登录-->
<div class="register J-loding jsLoginBox">
    <div class="login-type-change">
        <i id="goQrLogin" class="top-right-image"></i>
        <div class="login-type-change-tooltips">
            <div class="login-type-change-tooltips-content">扫码登录</div>
            <div class="login-type-change-tooltips-arrow"></div>
        </div>
    </div>
    <div class="register-logo"><img src="/static/img/resigin-1.png"></div>
    <div class="loding">
        <ul>
            <li class="active">
                <a href="javascript:void(0);">登录</a>
            </li>
            <li>
                <a href="javascript:void(0);">注册</a>
            </li>
        </ul>
    </div>
    <div class="regist-for regist-forone">
        <div class="phone-login">
            <div class="loding-form" style="height: 98px">
                <div class="form-tel">
                    <span>手机号</span><input type="text" name="loginPhone" value="" placeholder="请输入您的手机号">
                </div>
                <div class="form-tel" id="password-login-form">
                    <span>密码</span><input type="password" name="loginPassword" value="" placeholder="请输入您的密码">
                </div>
                <div class="form-tel" id="phone-login-form" style="display: none">
                    <span>验证码</span>
                    <input class="lodin-code" type="text" name="loginValidCode" value="" placeholder="请输入验证码">
                    <input type="text" name="" id="get-code-btn" value="获取验证码" class="lodin-button" readonly="readonly">
                </div>
            </div>
            <div class="forget">
            <span style="cursor: pointer;" id="forgetPwd">
                <span>忘记密码</span>
                <img src="/static/img/resigin-2.png" alt="">
            </span>
            </div>
            <div class="login-tips">
                <div>
                    登录即表示已同意 <span><a href="/protocol" target="_blank">《用户协议》</a><a href="/protocol" target="_blank">《隐私政策》</a></span>
                </div>
            </div>
            <div class="login-button" id="password-login-submit-button">
                <button type="button" id="password-login-submit" class="btn btn-primary">登 录</button>
            </div>
            <div class="login-button" id="phone-login-submit-button" style="display: none">
                <button type="button" id="phone-login-submit" class="btn btn-primary">登 录</button>
            </div>
            <div class="login-change">
                <div class="toggle-tips">
                    <span>其他登录方式</span>
                </div>
                <div class="login-way-wrap">
                    <button class="toggle-btn" id="phoneLoginChangeBtn">
                        <div class="icon">
                            <img src="/static/img/login-mobile.png" width="24px" height="24px" alt="">
                        </div>
                        <div style="color: #848484;">手机号登录</div>
                    </button>
                    <button class="toggle-btn" id="passwordLoginChangeBtn" style="display: none">
                        <div class="icon">
                            <img src="/static/img/login-account.png" width="24px" height="24px" alt="">
                        </div>
                        <div style="color: #848484;">账号登录</div>
                    </button>
                </div>
            </div>
        </div>
        <div class="qr-code-login" style="display: none">
            <div class="qr-code-login-content">
                <div style="width: 220px; height: 220px; border: 1px solid #e3e3e3; border-radius: 5px;">
                    <div id="qrcode" style="width:200px; height:200px; margin: 10px;">
                    <canvas width="200" height="200"></canvas><img alt="Scan me!" style="display: none;"></div>
                </div>
                <div id="state">请使用半导小芯APP扫码登录</div>

            </div>
            <div class="button download"><button type="button" class="btn btn-primary jsdownloadbdxx">下载半导小芯APP</button></div>
        </div>
    </div>
    <div class="regist-for regist-forone" style="display: none;">
        <div class="loding-form">
            <div class="form-tel">
                <span>手机号</span><input type="text" name="registerPhone" value="" placeholder="请输入您的手机号">
            </div>
            <div class="form-tel">
                <span>验证码</span>
                <input class="lodin-code" type="text" name="registerValidCode" value="" placeholder="请输入验证码">
                <input type="text" name="" id="btn" value="获取验证码" class="lodin-button" readonly="readonly">
            </div>
            <div class="form-tel">
                <span>密码</span><input type="password" name="registerPassword" id="" value="" placeholder="请输入6-20位字符">
            </div>
        </div>
        <div class="regree">
            注册即表示已同意 <span><a href="/protocol" target="_blank">《用户协议》</a><a href="/protocol" target="_blank">《隐私政策》</a></span>
        </div>
        <div class="button zhuce"><button type="button" id="register" class="btn btn-primary">注册半导小芯</button></div>
        <div class="button download"><button type="button" class="btn btn-primary jsdownloadbdxx">下载半导小芯APP</button></div>
    </div>
</div>

<!--找回密码-->
<div class="register J-found jsFindPwdBox">
    <div class="register-logo"><img src="/static/img/resigin-1.png"></div>
    <div class="loding">
        <ul>
            <li class="active">
                <a href="javascript:void(0);">手机找回</a>
            </li>
            <li>
                <a href="javascript:void(0);">邮箱找回</a>
            </li>
        </ul>
    </div>
    <div class="regist-for regist-fortwo">
        <div class="loding-form">
            <div class="form-tel">
                <span>手机号</span><input type="text" name="p_phone" value="" placeholder="请输入您的手机号">
            </div>
            <div class="form-tel">
                <span>验证码</span>
                <input class="lodin-code" type="text" name="p_validCode" value="" placeholder="请输入验证码">
                <input type="text" name="" id="btn1" value="获取验证码" class="lodin-button" readonly="readonly">
            </div>
            <div class="form-tel">
                <span>新密码</span><input type="password" name="p_password" value="" placeholder="请输入6-20位字符">
            </div>
        </div>
        <div class="button"><button type="button" id="p_findPwd" class="btn btn-primary">找回密码</button></div>
    </div>
    <div class="regist-for regist-fortwo" style="display: none;">
        <div class="loding-form">
            <div class="form-tel">
                <span>邮箱号</span><input type="text" name="e_email" value="" placeholder="请输入您的邮箱号">
            </div>
            <div class="form-tel">
                <span>验证码</span>
                <input class="lodin-code" type="text" name="e_validCode" value="" placeholder="请输入验证码">
                <input type="text" name="" id="btn2" value="获取验证码" class="lodin-button" readonly="readonly">
            </div>
            <div class="form-tel">
                <span>新密码</span><input type="password" name="e_password" value="" placeholder="请输入6-20位字符">
            </div>
        </div>
        <div class="button"><button type="button" id="e_findPwd" class="btn btn-primary">找回密码</button></div>
    </div>
</div>

<!--二维码-->
<div class="twocode">
    <div class="twocode-logo"><img src="/static/img/resigin-1.png"></div>
    <div style="width: 300px; height:298px;display: flex;justify-content: center;align-items: center;">
        <div class="twocode-ma" style="border: 1px solid #e3e3e3;border-radius: 5px;">
            <img src="/static/img/two-1.png">
        </div>
    </div>
    <div class="button download"><button type="button" class="btn btn-primary layui-layer-close" style="position: inherit;margin-top: 10px;">关闭二维码</button></div>
</div>

<script type="text/javascript">
    let qrCodeUrl = '';
    let qrCodeStatus = '';
    let qrCodeRefreshTimer;
    let associateTimer;

    var qrcode = new QRCode(document.getElementById("qrcode"), {
        width : 200,
        height : 200
    });

    // 联想
    // $("input[name=searchModel]").on('input', function () {
    //     let token = getToken();
    //     if (token) {
    //         clearTimeout(associateTimer);
    //         var query = $(this).val();
    //
    //         if (query.trim() === '') {
    //             $('.associate').hide();
    //             return;
    //         }
    //
    //         associateTimer = setTimeout(function () {
    //             ddGet('/chip/associate', {model: query}, function (dd) {
    //                 let result = dd.result;
    //                 var htm = '';
    //                 if (result && result.length > 0) {
    //                     $.each(result, function(index, item) {
    //                         htm += '<p class="asc">' + item.name + '</p>';
    //                     });
    //                     $(".hostory").hide();
    //                     $('.associate').html(htm);
    //                     $('.associate').show();
    //                 }
    //             })
    //         }, 300); // 延迟300毫秒
    //     }
    // });
    //
    // $('.associate').on('mousedown', '.asc', function () {
    //     $("input[name='searchModel']").val($(this).html());
    //     $('.associate').hide();
    // });
    //
    // $(document).on('click', function (e) {
    //     if (!$(e.target).closest('.top-serch input, .associate').length) {
    //         $('.associate').hide();
    //     }
    // });
    // 联想结束

    $('#searchModel').attr('autocomplete', 'off');
    // 在输入框获得焦点时禁用自动填充
    $('#searchModel').on('focus', function() {
        $(this).attr('autocomplete', 'off');
    });
    // 点击时禁用自动填充
    $('#searchModel').on('click', function() {
        $(this).attr('autocomplete', 'off');
    });

	$("input[name=searchModel]").keydown(function(event) {
        event.stopPropagation()
		if(event.keyCode==13){
		$("#search").click(); 
		} 
	});

    function displayRefresh() {
        $("#qrcode img").addClass('expired')
        $("#qrcode").addClass('expired')
        $("#qrcode").append('<div class="overlay"><button class="refresh-btn" onclick="refreshQRCode()"></button></div>');
        $("#state").html('二维码已过期，请刷新');
        clearInterval(qrCodeRefreshTimer);
    }

    var userToken = getToken();
    if (userToken) {
        ddGet("/user/info", {}, function (dd) {
            var res = dd.result;
            $("#userPhoneNumber").html(noPassByMobile(res['phone_num']));
            if(res['unread_msg_num'] == 0) {
            	$("#unreadMsgNum").hide();
            } else {
            	$("#unreadMsgNum").show();
            	$("#unreadMsgNum").html(res['unread_msg_num']);
            }
            $("#alrLoginBox").show();
        }, function (msg) {
            layer.alert(msg, {closeBtn: 0});
        }, true);
    } else {
        $("#notLoginBox").show();
    }

    // 星号处理手机号
    function noPassByMobile(str){
        if(null != str && str != undefined){
            var pat=/(\d{3})\d*(\d{4})/;
            return str.replace(pat,'$1****$2');
        } else {
            return "";
        }
    }

    // 刷新二维码
    function refreshQRCode() {
        getUrl();
        $("#qrcode img").removeClass('expired')
        $("#qrcode").removeClass('expired')
        $("#qrcode").children('.overlay').remove();
    }

    // 获取二维码
    function getUrl() {
        ddGet('/qrcode/getQrCode', {}, function (dd) {
            qrcode.makeCode(dd.result.qrUrl);

            qrCodeRefreshTimer = setInterval(function () {
                check(dd.result.qrCode);
            }, 2000);
        })
    }

    // 查询二维码状态
    function check(qrCode) {
        ddGet('/qrcode/getQrCodeState', {'qrCode': qrCode}, function (response) {
            let expireState = response.result.expireState;
            if (expireState == '1') {
                $("#qrcode img").addClass('expired')
                $("#qrcode").addClass('expired')
                $("#qrcode").append('<div class="overlay"><button class="refresh-btn" onclick="refreshQRCode()"></button></div>');
                $("#state").html('二维码已过期，请刷新');
                clearInterval(qrCodeRefreshTimer);
                return;
            }
            var qrState = response.result.qrState;
            if (qrState == '0') {
                $("#state").html('请使用半导小芯APP扫码登录');
            } else if (qrState == '1') {
                $("#state").html('扫码成功，请在半导小芯APP确认登录');
            } else if (qrState == '2') {
                clearInterval(qrCodeRefreshTimer);
                $("#state").html('2-已登录');
                var token = response.result.loginResult.token;
                saveToken(token);
                layer.closeAll();
                window.location.reload();
            }
        })
    }

    // 样品申请
    function sampleApply(chip, model) {
        let userToken = getToken();
        if (userToken) {
            layer.close();
            layer.open({
                type: 1,
                title: "样品申请",
                closeBtn: 1,
                area: ['400', 'auto'],
                skin: 'layui-layer-nobg', //没有背景色
                shadeClose: false,
                content: $('.j-sample-apply'),
                success: function (layero, index) {
                    initSampleApply(chip, model);
                },
            });
        } else {
            openLogin();
        }
    }

    $(function () {

        $("#goQrLogin").click(function () {
            let phoneLogin = $(this).hasClass('go-phone-login');
            if (!phoneLogin) {
                getUrl();
                $("#goQrLogin").addClass('go-phone-login');
                $(".phone-login").hide();
                $(".qr-code-login").show();
                $(".login-type-change-tooltips-content").text("账号登录");
            } else {
                clearInterval(qrCodeRefreshTimer);
                $("#goQrLogin").removeClass('go-phone-login');
                $(".qr-code-login").hide();
                $(".phone-login").show();
                $(".login-type-change-tooltips-content").text("扫码登录");
            }
        })

        $("#phoneLoginChangeBtn").click(function () {
            $("#phoneLoginChangeBtn").hide();
            $("#passwordLoginChangeBtn").show();
            $("#password-login-form").hide();
            $("#phone-login-form").show();
            $("#password-login-submit-button").hide();
            $("#phone-login-submit-button").show();
            $(".forget").hide();
            $(".login-tips").show();
        })
        $("#passwordLoginChangeBtn").click(function () {
            $("#passwordLoginChangeBtn").hide();
            $("#phoneLoginChangeBtn").show();
            $("#phone-login-form").hide();
            $("#password-login-form").show();
            $("#phone-login-submit-button").hide();
            $("#password-login-submit-button").show();
            $(".login-tips").hide();
            $(".forget").show();
        })


        $('.top-serch input').focus(function () {
            let isShow = $(this).siblings('.associate').is(':visible');
            if (!isShow) {
                var historys = getHistory($(this).val());
                if(historys.length > 0) {
                    var htm = '';
                    $.each(historys, function(index, item) {
                        htm += '<p class="his">' + item.content + '</p>';
                    });
                    $('.hostory-his-search-div').html(htm);
                }
                // 热搜
                loadHotSearch();
                $('.hostory').show();
            }

		});
		
		$('.top-serch input').bind('input propertychange', function() {
            let isShow = $(this).siblings('.associate').is(':visible');
            if (!isShow) {
                var historys = getHistory($(this).val());
                if (historys.length > 0) {
                    var htm = '';
                    $.each(historys, function (index, item) {
                        htm += '<p class="his">' + item.content + '</p>';
                    });
                    $('.hostory-his-search-div').html(htm);
                }
                // 热搜
                loadHotSearch();
                $('.hostory').show();
            }
        });

        function loadHotSearch() {
            var req = {
                "pageIndex": 0,
                "pageSize": 16
            }
            ddGet("/chip/hotsearch", req, function (dd) {
                let result = dd.result;
                if (result) {
                    var htm = ''
                    for (let key in result) {
                        htm += '<p class="his">' + result[key]['model'] + '</p>'
                    }
                    $('.hostory-hot-search-div').html(htm);
                }
            })
        }

        $("#hostory-his-search-clear").click(function (e) {
            $(".hostory-his-search-div").empty();
            delHistory();
        });

        $(document).on('click', function (e) {
            if (!$(e.target).closest('.top-serch input, .hostory').length) {
                $('.hostory').hide();
            }
        });
		
		$('.hostory').on('mousedown', '.his', function() {
			$("input[name='searchModel']").val($(this).html());
			$('.hostory').hide();
		});
		
		// $('.top-serch input').blur(function(){
		// 	$('.hostory').hide();
        //  $('.associate').hide();
		// });
    	
    	
        $('.top-news .tel').hover(function () {
            $('.slide-news').slideDown();
        }, function () {
            $('.slide-news').slideUp();
        });

        $('.eeService').hover(function () {
            $('.ee-service-item').slideDown();
        }, function () {
            $('.ee-service-item').slideUp();
        });

        $('.jsLoginBox .loding li').on('click', function () {
            var _index = $(this).index();
            if (_index === 1) {
                // 注册隐藏扫码登录标签
                $(".login-type-change").hide();
                clearInterval(qrCodeRefreshTimer)
            } else {
                $(".login-type-change").show();
            }
            $(this).addClass('active').siblings('li').removeClass('active');
            $('.regist-forone').eq(_index).show().siblings('.regist-forone').hide();
            $("input[name='loginPhone']").val('');
            $("input[name='loginPassword']").val('');
            $("input[name='registerValidCode']").val('');
            $("input[name='registerPhone']").val('');
            $("input[name='registerPassword']").val('');
            $("input[name='loginValidCode']").val('');
        });

        $('.jsFindPwdBox .loding li').on('click', function () {
            var _index = $(this).index();
            $(this).addClass('active').siblings('li').removeClass('active');
            $('.regist-fortwo').eq(_index).show().siblings('.regist-fortwo').hide();
            $("input[name='p_phone']").val('');
            $("input[name='p_validCode']").val('');
            $("input[name='p_password']").val('');
            $("input[name='e_email']").val('');
            $("input[name='e_validCode']").val('');
            $("input[name='e_password']").val('');
        });

        var wait = 60;
        document.getElementById("btn").disabled = false;

        function time(o) {
            if (wait == 0) {
                o.removeAttribute("disabled");
                o.value = "获取验证码";
                wait = 60;
            } else {
                o.setAttribute("disabled", true);
                o.value = "重新发送" + wait + "";
                wait--;
                setTimeout(function () {
                    time(o);
                }, 1000);
            }
        }

        document.getElementById("get-code-btn").onclick = function () {
            let loginPhone = $("input[name='loginPhone']").val();
            if (!loginPhone) {
                layer.alert("请填写手机号", {closeBtn: 0});
                return;
            }
            // showCaptchaDialog(function(isVerified) {
            //     if (isVerified) {
            var obj = this;
            var vo = {
                "type": 1,
                "username": loginPhone
            };
            ddPost("/index/getCode", vo, function (dd) {
                time(obj);
            }, function (msg) {
                layer.alert(msg, {closeBtn: 0});
            }, true);
            // }
            // }.bind(this));
        };
        document.getElementById("btn").onclick = function () {
            var obj = this;
            var vo = {
                "type": 1,
                "username": $("input[name='registerPhone']").val()
            };
            ddPost("/index/getCode", vo, function (dd) {
                time(obj);
            }, function (msg) {
                layer.alert(msg, {closeBtn: 0});
            }, true);
        };
        document.getElementById("btn1").onclick = function () {
            var obj = this;
            var vo = {
                "type": 1,
                "username": $("input[name='p_phone']").val()
            };
            ddPost("/index/getCode", vo, function (dd) {
                time(obj);
            }, function (msg) {
                layer.alert(msg, {closeBtn: 0});
            }, true);
        };
        document.getElementById("btn2").onclick = function () {
            var obj = this;
            var vo = {
                "type": 2,
                "username": $("input[name='e_email']").val()
            };
            ddPost("/index/getCode", vo, function (dd) {
                time(obj);
            }, function (msg) {
                layer.alert(msg, {closeBtn: 0});
            }, true);
        };

        //登录弹框
        $('.jsLoginPage').on('click', function () {
            $('.register .loding li').eq(0).addClass('active').siblings('li').removeClass('active');
            $('.regist-forone').eq(0).show().siblings('.regist-forone').hide();
            $("input[name='loginPhone']").val('');
            $("input[name='loginPassword']").val('');
            $("input[name='registerValidCode']").val('');
            $("input[name='registerPhone']").val('');
            $("input[name='registerPassword']").val('');
            $("input[name='loginValidCode']").val('');
            $("#passwordLoginChangeBtn").click();
            $(".login-type-change").show();
            layer.open({
                type: 1,
                title: false,
                closeBtn: 1,
                area: ['400px', '521px'],
                skin: 'layui-layer-nobg', //没有背景色
                shadeClose: true,
                content: $('.J-loding')
            });
        });

        //下载半导小芯APP
        $('.jsdownloadbdxx').on('click', function () {
            layer.closeAll();
            layer.open({
                type: 1,
                title: false,
                closeBtn: false,
                area: ['auto', 'auto'],
                skin: 'layui-layer-nobg', //没有背景色
                shadeClose: true,
                content: $('.twocode')
            });
        });

        //找回密码
        $('#forgetPwd').on('click', function () {
            layer.closeAll();
            $("input[name='p_phone']").val('');
            $("input[name='p_validCode']").val('');
            $("input[name='p_password']").val('');
            $("input[name='e_email']").val('');
            $("input[name='e_validCode']").val('');
            $("input[name='e_password']").val('');
            layer.open({
                type: 1,
                title: false,
                closeBtn: 1,
                area: ['400px', 'auto'],
                skin: 'layui-layer-nobg', //没有背景色
                shadeClose: true,
                content: $('.J-found')
            });
        });

        //登录
        $("#password-login-submit").click(function () {
            var vo = {
                "type": 0,
                "deviceId": getDeviceId(),
                "username": $("input[name='loginPhone']").val(),
                "password": $("input[name='loginPassword']").val()
            };
            ddPost("/index/login", vo, function (dd) {
                var res = dd.result;
                saveToken(res['token']);
                layer.closeAll();
                window.location.reload();
            }, function (msg) {
                layer.alert(msg, {closeBtn: 0});
            }, true);
        });

        //手机号登录
        $("#phone-login-submit").click(function () {
            let phone = $("input[name='loginPhone']").val();
            let validCode = $("input[name='loginValidCode']").val();
            if (!phone) {
                layer.alert("请填写手机号", {closeBtn: 0});
                return;
            }
            if (!validCode) {
                layer.alert("请填写验证码", {closeBtn: 0});
                return;
            }
            var vo = {
                "type": 1,
                "username": phone,
                "code": validCode
            };
            ddPost("/index/codeLogin", vo, function (dd) {
                var res = dd.result;
                saveToken(res['token']);
                layer.closeAll();
                window.location.reload();
            }, function (msg) {
                layer.alert(msg, {closeBtn: 0});
            }, true);
        });

        //注册
        $("#register").click(function () {
            var vo = {
                "code": $("input[name='registerValidCode']").val(),
                "phone": $("input[name='registerPhone']").val(),
                "password": $("input[name='registerPassword']").val()
            };
            ddPost("/index/register", vo, function (dd) {
                layer.alert('注册成功', {closeBtn: 0}, function () {
                    layer.closeAll();
                });
            }, function (msg) {
                layer.alert(msg, {closeBtn: 0});
            }, true);
        });

        //手机找回密码
        $("#p_findPwd").click(function () {
            var vo = {
                "code": $("input[name='p_validCode']").val(),
                "password": $("input[name='p_password']").val(),
                "phone": $("input[name='p_phone']").val()
            };
            ddPost("/index/forgetPwd/phone", vo, function (dd) {
                layer.alert('找回密码成功', {closeBtn: 0}, function () {
                    layer.closeAll();
                    
                    $('.register .loding li').eq(0).addClass('active').siblings('li').removeClass('active');
                    $('.regist-forone').eq(0).show().siblings('.regist-forone').hide();
                    $("input[name='loginPhone']").val('');
                    $("input[name='loginPassword']").val('');
                    $("input[name='registerValidCode']").val('');
                    $("input[name='registerPhone']").val('');
                    $("input[name='registerPassword']").val('');
                    $("input[name='loginValidCode']").val('');
                    $("#passwordLoginChangeBtn").click();
                    $(".login-type-change").show();
                    layer.open({
                        type: 1,
                        title: false,
                        closeBtn: 1,
                        area: ['400px', '521px'],
                        skin: 'layui-layer-nobg', //没有背景色
                        shadeClose: true,
                        content: $('.J-loding')
                    });
                });
            }, function (msg) {
                layer.alert(msg, {closeBtn: 0});
            }, true);
        });

        //邮箱找回密码
        $("#e_findPwd").click(function () {
            var vo = {
                "code": $("input[name='e_validCode']").val(),
                "password": $("input[name='e_password']").val(),
                "email": $("input[name='e_email']").val()
            };
            ddPost("/index/forgetPwd/email", vo, function (dd) {
                layer.alert('找回密码成功', {closeBtn: 0}, function () {
                    layer.closeAll();
                    
                });
            }, function (msg) {
                layer.alert(msg, {closeBtn: 0});
            }, true);
        });

        //个人导航栏
        $(".js_self_nav_bar").click(function () {
            var type = $(this).data('type');
            if (type == '1') {
                window.location.href = ctx + '/myNews';
            } else if (type == '2') {
                window.location.href = ctx + '/myCollection';
            } else if (type == '3') {
                window.location.href = ctx + '/recentlyBrowse';
            } else if (type == '4') {
                window.location.href = ctx + '/bindMailbox';
            } else if (type == '5') {
                window.location.href = ctx + '/myBrandCollection';
            } else if (type == '6') {
                layer.confirm('确定退出？', {closeBtn: false}, function (index) {
                    layer.closeAll();
                    delToken();
                    window.location.reload();
                });
            } else if (type == 'bom') {
                window.location.href = ctx + '/bom/index';
            }
        });

        //清除搜索
        $("#clear").click(function () {
            $("input[name='searchModel']").val('');
        });
        
        $(".message").click(function() {
    		window.location.href = ctx + '/myNews';
    	});

        $(".bom-upload").on('click', function (e) {
            $('.j-bom-upload').show();
        })

        $(document).on('click', function (e) {
            if (!$(e.target).closest('.bom-upload, .j-bom-upload, .delete-btn').length) {
                $('.j-bom-upload').hide();
            }
        });
    });
</script>

		<div class="search-result">
			<div class="once-search">
				<div class="once-search-category"><a href="/">首页</a> &gt; <a href="/brand/index?brandUid=8d190e00196ba9502099586b881b1abb" target="_blank">德州仪器-TI</a> &gt; <span id="cate-text">降压DC-DC</span></div>
				<div class="once-search-form"><div class="once-search-form-item"><h2>品牌</h2><div class="select"><ul names="param_brand" data-type="multiple"><li id="param_brand_14" data-code="14">德州仪器-TI</li></ul></div></div><div class="once-search-form-item"><h2>品牌</h2><div class="select searchItems" data-type="select" data-id="419" data-code="BX100"><ul names="param_419" data-type="single"><li id="param_419_2" data-code="2">国内品牌</li><li id="param_419_1" data-code="1">国外品牌</li></ul></div></div><div class="once-search-form-item"><h2>等级</h2><div class="select searchItems" data-type="select" data-id="3016" data-code="BX3"><ul names="param_3016" data-type="single"><li id="param_3016_1" data-code="1">普通级</li><li id="param_3016_2" data-code="2">汽车级</li><li id="param_3016_3" data-code="3">高可靠性</li></ul></div></div><div class="once-search-form-item"><h2>开关管配置</h2><div class="select searchItems" data-type="select" data-id="422" data-code="BX6"><ul names="param_422" data-type="single"><li id="param_422_1" data-code="1">转换器(内置MOS)</li><li id="param_422_2" data-code="2">控制器(集成驱动器)</li><li id="param_422_4" data-code="4">控制器(外置驱动器)</li></ul></div></div><div class="once-search-form-item"><h2>同步/异步电路拓扑</h2><div class="select searchItems" data-type="select" data-id="423" data-code="BX7"><ul names="param_423" data-type="single"><li id="param_423_1" data-code="1">同步</li><li id="param_423_2" data-code="2">异步</li></ul></div></div><div class="once-search-form-item"><h2>最大通道数</h2><div class="select searchItems" data-type="select" data-id="424" data-code="BX8"><ul names="param_424" data-type="single"><li id="param_424_1" data-code="1">1通道</li><li id="param_424_2" data-code="2">2通道</li><li id="param_424_3" data-code="3">3通道</li><li id="param_424_4" data-code="4">4通道</li><li id="param_424_5" data-code="5">5通道</li><li id="param_424_8" data-code="8">8通道</li></ul></div></div><div class="once-search-form-item"><h2>常用最大输入电压</h2><div class="select searchItems" data-type="select" data-id="16961" data-code="CBX1"><ul names="param_16961" data-type="single"><li id="param_16961_5" data-code="5">5V</li><li id="param_16961_5.5" data-code="5.5">5.5V</li><li id="param_16961_6" data-code="6">6V</li><li id="param_16961_12" data-code="12">12V</li><li id="param_16961_16" data-code="16">16V</li><li id="param_16961_17" data-code="17">17V</li><li id="param_16961_18" data-code="18">18V</li><li id="param_16961_20" data-code="20">20V</li><li id="param_16961_23" data-code="23">23V</li><li id="param_16961_24" data-code="24">24V</li><li id="param_16961_25" data-code="25">25V</li><li id="param_16961_28" data-code="28">28V</li><li id="param_16961_30" data-code="30">30V</li><li id="param_16961_36" data-code="36">36V</li><li id="param_16961_40" data-code="40">40V</li><li id="param_16961_42" data-code="42">42V</li><li id="param_16961_60" data-code="60">60V</li><li id="param_16961_75" data-code="75">75V</li><li id="param_16961_100" data-code="100">100V</li><li id="param_16961_N" data-code="N">其它</li></ul></div></div><div class="once-search-form-item"><h2>常用最大输出电流</h2><div class="select searchItems" data-type="select" data-id="16962" data-code="CBX2"><ul names="param_16962" data-type="single"><li id="param_16962_0.1" data-code="0.1">0.1A</li><li id="param_16962_0.2" data-code="0.2">0.2A</li><li id="param_16962_0.3" data-code="0.3">0.3A</li><li id="param_16962_0.5" data-code="0.5">0.5A</li><li id="param_16962_0.8" data-code="0.8">0.8A</li><li id="param_16962_1" data-code="1">1A</li><li id="param_16962_1.5" data-code="1.5">1.5A</li><li id="param_16962_2" data-code="2">2A</li><li id="param_16962_2.5" data-code="2.5">2.5A</li><li id="param_16962_3" data-code="3">3A</li><li id="param_16962_3.5" data-code="3.5">3.5A</li><li id="param_16962_4" data-code="4">4A</li><li id="param_16962_5" data-code="5">5A</li><li id="param_16962_6" data-code="6">6A</li><li id="param_16962_8" data-code="8">8A</li><li id="param_16962_10" data-code="10">10A</li><li id="param_16962_15" data-code="15">15A</li><li id="param_16962_N" data-code="N">其它</li></ul></div></div><div class="once-search-form-item"><h2>接口类型</h2><div class="select searchItems" data-type="select" data-id="426" data-code="BX12"><ul names="param_426" data-type="single"><li id="param_426_1" data-code="1">I2C</li><li id="param_426_4" data-code="4">SVID</li><li id="param_426_N" data-code="N">无接口</li></ul></div></div><div class="once-search-form-item"><h2>最小工作电压(V)</h2><div class="select searchItems" data-type="range" data-id="5513" data-code="CS3"><div class="range-slider"><div id="slider-5513" class="ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" aria-disabled="false"><div class="ui-slider-range ui-widget-header ui-corner-all" style="bottom: 0%; height: 100%;"></div><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 0%;"></a><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 100%;"></a></div><div class="slider-input-container" names="param_5513" data-code="CS3"><input type="text" id="range-5513-max" class="slider-input max-input" data-old_value="60" value="60"><input type="text" id="range-5513-min" class="slider-input min-input" data-old_value="0" value="0"></div></div></div><script>
$(function(){	$("#slider-5513").slider({
		orientation: "vertical",
		range: true,
		min: 0,
		max: 60,
		step: 0.1,
		values: [ 0, 60 ],
		slide: function( event, ui ) {
			$("#range-5513-max").val(ui.values[1]);
			$("#range-5513-min").val(ui.values[0]);
		},
		change: function( event, ui ) {
			rangeChange(5513,"CS3","V");
			getSearchCfgCount();
		}
	});
	$("#range-5513-max").on("change", function(){		$("#slider-5513").slider("option","values", [$("#range-5513-min").val(), $("#range-5513-max").val()]);
		getSearchCfgCount();
	});
	$("#range-5513-min").on("change", function(){		$("#slider-5513").slider("option","values", [$("#range-5513-min").val(), $("#range-5513-max").val()]);
		getSearchCfgCount();
	});
});
</script></div><div class="once-search-form-item"><h2>最大工作电压(V)</h2><div class="select searchItems" data-type="range" data-id="429" data-code="CS4"><div class="range-slider"><div id="slider-429" class="ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" aria-disabled="false"><div class="ui-slider-range ui-widget-header ui-corner-all" style="bottom: 0%; height: 100%;"></div><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 0%;"></a><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 100%;"></a></div><div class="slider-input-container" names="param_429" data-code="CS4"><input type="text" id="range-429-max" class="slider-input max-input" data-old_value="200" value="200"><input type="text" id="range-429-min" class="slider-input min-input" data-old_value="0" value="0"></div></div></div><script>
$(function(){	$("#slider-429").slider({
		orientation: "vertical",
		range: true,
		min: 0,
		max: 200,
		step: 0.1,
		values: [ 0, 200 ],
		slide: function( event, ui ) {
			$("#range-429-max").val(ui.values[1]);
			$("#range-429-min").val(ui.values[0]);
		},
		change: function( event, ui ) {
			rangeChange(429,"CS4","V");
			getSearchCfgCount();
		}
	});
	$("#range-429-max").on("change", function(){		$("#slider-429").slider("option","values", [$("#range-429-min").val(), $("#range-429-max").val()]);
		getSearchCfgCount();
	});
	$("#range-429-min").on("change", function(){		$("#slider-429").slider("option","values", [$("#range-429-min").val(), $("#range-429-max").val()]);
		getSearchCfgCount();
	});
});
</script></div><div class="once-search-form-item"><h2>支持电源相位数</h2><div class="select searchItems" data-type="range" data-id="5512" data-code="CSMUL1"><div class="range-slider"><div id="slider-5512" class="ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" aria-disabled="false"><div class="ui-slider-range ui-widget-header ui-corner-all" style="bottom: 0%; height: 100%;"></div><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 0%;"></a><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 100%;"></a></div><div class="slider-input-container" names="param_5512" data-code="CSMUL1"><input type="text" id="range-5512-max" class="slider-input max-input" data-old_value="20" value="20"><input type="text" id="range-5512-min" class="slider-input min-input" data-old_value="1" value="1"></div></div></div><script>
$(function(){	$("#slider-5512").slider({
		orientation: "vertical",
		range: true,
		min: 1,
		max: 20,
		step: 1,
		values: [ 1, 20 ],
		slide: function( event, ui ) {
			$("#range-5512-max").val(ui.values[1]);
			$("#range-5512-min").val(ui.values[0]);
		},
		change: function( event, ui ) {
			rangeChange(5512,"CSMUL1","");
			getSearchCfgCount();
		}
	});
	$("#range-5512-max").on("change", function(){		$("#slider-5512").slider("option","values", [$("#range-5512-min").val(), $("#range-5512-max").val()]);
		getSearchCfgCount();
	});
	$("#range-5512-min").on("change", function(){		$("#slider-5512").slider("option","values", [$("#range-5512-min").val(), $("#range-5512-max").val()]);
		getSearchCfgCount();
	});
});
</script></div><div class="once-search-form-item"><h2>静态工作电流(uA)</h2><div class="select searchItems" data-type="range" data-id="3017" data-code="CS9"><div class="range-slider"><div id="slider-3017" class="ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" aria-disabled="false"><div class="ui-slider-range ui-widget-header ui-corner-all" style="bottom: 0%; height: 100%;"></div><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 0%;"></a><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 100%;"></a></div><div class="slider-input-container" names="param_3017" data-code="CS9"><input type="text" id="range-3017-max" class="slider-input max-input" data-old_value="50000" value="50000"><input type="text" id="range-3017-min" class="slider-input min-input" data-old_value="0" value="0"></div></div></div><script>
$(function(){	$("#slider-3017").slider({
		orientation: "vertical",
		range: true,
		min: 0,
		max: 50000,
		step: 0.1,
		values: [ 0, 50000 ],
		slide: function( event, ui ) {
			$("#range-3017-max").val(ui.values[1]);
			$("#range-3017-min").val(ui.values[0]);
		},
		change: function( event, ui ) {
			rangeChange(3017,"CS9","uA");
			getSearchCfgCount();
		}
	});
	$("#range-3017-max").on("change", function(){		$("#slider-3017").slider("option","values", [$("#range-3017-min").val(), $("#range-3017-max").val()]);
		getSearchCfgCount();
	});
	$("#range-3017-min").on("change", function(){		$("#slider-3017").slider("option","values", [$("#range-3017-min").val(), $("#range-3017-max").val()]);
		getSearchCfgCount();
	});
});
</script></div><div class="once-search-form-item"><h2>最大输出电流(A)</h2><div class="select searchItems" data-type="range" data-id="3018" data-code="CS10"><div class="range-slider"><div id="slider-3018" class="ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" aria-disabled="false"><div class="ui-slider-range ui-widget-header ui-corner-all" style="bottom: 0%; height: 100%;"></div><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 0%;"></a><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 100%;"></a></div><div class="slider-input-container" names="param_3018" data-code="CS10"><input type="text" id="range-3018-max" class="slider-input max-input" data-old_value="120" value="120"><input type="text" id="range-3018-min" class="slider-input min-input" data-old_value="0" value="0"></div></div></div><script>
$(function(){	$("#slider-3018").slider({
		orientation: "vertical",
		range: true,
		min: 0,
		max: 120,
		step: 0.01,
		values: [ 0, 120 ],
		slide: function( event, ui ) {
			$("#range-3018-max").val(ui.values[1]);
			$("#range-3018-min").val(ui.values[0]);
		},
		change: function( event, ui ) {
			rangeChange(3018,"CS10","A");
			getSearchCfgCount();
		}
	});
	$("#range-3018-max").on("change", function(){		$("#slider-3018").slider("option","values", [$("#range-3018-min").val(), $("#range-3018-max").val()]);
		getSearchCfgCount();
	});
	$("#range-3018-min").on("change", function(){		$("#slider-3018").slider("option","values", [$("#range-3018-min").val(), $("#range-3018-max").val()]);
		getSearchCfgCount();
	});
});
</script></div><div class="once-search-form-item"><h2>最大驱动电流(A)</h2><div class="select searchItems" data-type="range" data-id="434" data-code="CS11"><div class="range-slider"><div id="slider-434" class="ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" aria-disabled="false"><div class="ui-slider-range ui-widget-header ui-corner-all" style="bottom: 0%; height: 100%;"></div><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 0%;"></a><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 100%;"></a></div><div class="slider-input-container" names="param_434" data-code="CS11"><input type="text" id="range-434-max" class="slider-input max-input" data-old_value="6" value="6"><input type="text" id="range-434-min" class="slider-input min-input" data-old_value="0" value="0"></div></div></div><script>
$(function(){	$("#slider-434").slider({
		orientation: "vertical",
		range: true,
		min: 0,
		max: 6,
		step: 0.01,
		values: [ 0, 6 ],
		slide: function( event, ui ) {
			$("#range-434-max").val(ui.values[1]);
			$("#range-434-min").val(ui.values[0]);
		},
		change: function( event, ui ) {
			rangeChange(434,"CS11","A");
			getSearchCfgCount();
		}
	});
	$("#range-434-max").on("change", function(){		$("#slider-434").slider("option","values", [$("#range-434-min").val(), $("#range-434-max").val()]);
		getSearchCfgCount();
	});
	$("#range-434-min").on("change", function(){		$("#slider-434").slider("option","values", [$("#range-434-min").val(), $("#range-434-max").val()]);
		getSearchCfgCount();
	});
});
</script></div><div class="once-search-form-item"><h2>最大开关频率(KHz)</h2><div class="select searchItems" data-type="range" data-id="3019" data-code="CS12"><div class="range-slider"><div id="slider-3019" class="ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" aria-disabled="false"><div class="ui-slider-range ui-widget-header ui-corner-all" style="bottom: 0%; height: 100%;"></div><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 0%;"></a><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 100%;"></a></div><div class="slider-input-container" names="param_3019" data-code="CS12"><input type="text" id="range-3019-max" class="slider-input max-input" data-old_value="20000" value="20000"><input type="text" id="range-3019-min" class="slider-input min-input" data-old_value="10" value="10"></div></div></div><script>
$(function(){	$("#slider-3019").slider({
		orientation: "vertical",
		range: true,
		min: 10,
		max: 20000,
		step: 1,
		values: [ 10, 20000 ],
		slide: function( event, ui ) {
			$("#range-3019-max").val(ui.values[1]);
			$("#range-3019-min").val(ui.values[0]);
		},
		change: function( event, ui ) {
			rangeChange(3019,"CS12","KHz");
			getSearchCfgCount();
		}
	});
	$("#range-3019-max").on("change", function(){		$("#slider-3019").slider("option","values", [$("#range-3019-min").val(), $("#range-3019-max").val()]);
		getSearchCfgCount();
	});
	$("#range-3019-min").on("change", function(){		$("#slider-3019").slider("option","values", [$("#range-3019-min").val(), $("#range-3019-max").val()]);
		getSearchCfgCount();
	});
});
</script></div><div class="once-search-form-item"><h2>输出电压精度(%)</h2><div class="select searchItems" data-type="range" data-id="431" data-code="CS6"><div class="range-slider"><div id="slider-431" class="ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" aria-disabled="false"><div class="ui-slider-range ui-widget-header ui-corner-all" style="bottom: 0%; height: 100%;"></div><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 0%;"></a><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 100%;"></a></div><div class="slider-input-container" names="param_431" data-code="CS6"><input type="text" id="range-431-max" class="slider-input max-input" data-old_value="10" value="10"><input type="text" id="range-431-min" class="slider-input min-input" data-old_value="0" value="0"></div></div></div><script>
$(function(){	$("#slider-431").slider({
		orientation: "vertical",
		range: true,
		min: 0,
		max: 10,
		step: 0.1,
		values: [ 0, 10 ],
		slide: function( event, ui ) {
			$("#range-431-max").val(ui.values[1]);
			$("#range-431-min").val(ui.values[0]);
		},
		change: function( event, ui ) {
			rangeChange(431,"CS6","%");
			getSearchCfgCount();
		}
	});
	$("#range-431-max").on("change", function(){		$("#slider-431").slider("option","values", [$("#range-431-min").val(), $("#range-431-max").val()]);
		getSearchCfgCount();
	});
	$("#range-431-min").on("change", function(){		$("#slider-431").slider("option","values", [$("#range-431-min").val(), $("#range-431-max").val()]);
		getSearchCfgCount();
	});
});
</script></div><div class="once-search-form-item"><h2>最小工作温度(℃)</h2><div class="select searchItems" data-type="range" data-id="427" data-code="CS1"><div class="range-slider"><div id="slider-427" class="ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" aria-disabled="false"><div class="ui-slider-range ui-widget-header ui-corner-all" style="bottom: 0%; height: 100%;"></div><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 0%;"></a><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 100%;"></a></div><div class="slider-input-container" names="param_427" data-code="CS1"><input type="text" id="range-427-max" class="slider-input max-input" data-old_value="0" value="0"><input type="text" id="range-427-min" class="slider-input min-input" data-old_value="-65" value="-65"></div></div></div><script>
$(function(){	$("#slider-427").slider({
		orientation: "vertical",
		range: true,
		min: -65,
		max: 0,
		step: 1,
		values: [ -65, 0 ],
		slide: function( event, ui ) {
			$("#range-427-max").val(ui.values[1]);
			$("#range-427-min").val(ui.values[0]);
		},
		change: function( event, ui ) {
			rangeChange(427,"CS1","℃");
			getSearchCfgCount();
		}
	});
	$("#range-427-max").on("change", function(){		$("#slider-427").slider("option","values", [$("#range-427-min").val(), $("#range-427-max").val()]);
		getSearchCfgCount();
	});
	$("#range-427-min").on("change", function(){		$("#slider-427").slider("option","values", [$("#range-427-min").val(), $("#range-427-max").val()]);
		getSearchCfgCount();
	});
});
</script></div><div class="once-search-form-item"><h2>最大工作温度(℃)</h2><div class="select searchItems" data-type="range" data-id="428" data-code="CS2"><div class="range-slider"><div id="slider-428" class="ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" aria-disabled="false"><div class="ui-slider-range ui-widget-header ui-corner-all" style="bottom: 0%; height: 100%;"></div><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 0%;"></a><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 100%;"></a></div><div class="slider-input-container" names="param_428" data-code="CS2"><input type="text" id="range-428-max" class="slider-input max-input" data-old_value="210" value="210"><input type="text" id="range-428-min" class="slider-input min-input" data-old_value="60" value="60"></div></div></div><script>
$(function(){	$("#slider-428").slider({
		orientation: "vertical",
		range: true,
		min: 60,
		max: 210,
		step: 1,
		values: [ 60, 210 ],
		slide: function( event, ui ) {
			$("#range-428-max").val(ui.values[1]);
			$("#range-428-min").val(ui.values[0]);
		},
		change: function( event, ui ) {
			rangeChange(428,"CS2","℃");
			getSearchCfgCount();
		}
	});
	$("#range-428-max").on("change", function(){		$("#slider-428").slider("option","values", [$("#range-428-min").val(), $("#range-428-max").val()]);
		getSearchCfgCount();
	});
	$("#range-428-min").on("change", function(){		$("#slider-428").slider("option","values", [$("#range-428-min").val(), $("#range-428-max").val()]);
		getSearchCfgCount();
	});
});
</script></div><div class="once-search-form-item"><h2>应用类型</h2><div class="select searchItems" data-type="select" data-id="5509" data-code="BX2"><ul names="param_5509" data-type="single"><li id="param_5509_N" data-code="N">通用</li><li id="param_5509_1" data-code="1">CPU电源</li><li id="param_5509_2" data-code="2">射频电源</li><li id="param_5509_4" data-code="4">LNB电源</li></ul></div></div><div class="once-search-form-item"><h2>输出电压设置类型</h2><div class="select searchItems" data-type="select" data-id="5510" data-code="BX10"><ul names="param_5510" data-type="single"><li id="param_5510_1" data-code="1">固定电压</li><li id="param_5510_2" data-code="2">电阻可调</li><li id="param_5510_3" data-code="3">可编程</li><li id="param_5510_4" data-code="4">可调基准</li></ul></div></div><div class="once-search-form-item"><h2>频率设置类型</h2><div class="select searchItems" data-type="select" data-id="5511" data-code="BX11"><ul names="param_5511" data-type="single"><li id="param_5511_1" data-code="1">固定频率</li><li id="param_5511_2" data-code="2">外部可调</li><li id="param_5511_3" data-code="3">内部自调节</li></ul></div></div><div class="once-search-form-item"><h2>功能</h2><div class="select"><ul names="param_func" data-type="multiple"><li id="param_func_GN1" data-code="GN1">可调软启动</li><li id="param_func_GN2" data-code="GN2">工作状态指示</li><li id="param_func_GN3" data-code="GN3">外部补偿</li><li id="param_func_GN4" data-code="GN4">轻载高效模式</li><li id="param_func_GN5" data-code="GN5">动态电压调节</li><li id="param_func_GN6" data-code="GN6">EMI优化(抖频模式)</li><li id="param_func_GN7" data-code="GN7">输出电压差分采样</li><li id="param_func_GN8" data-code="GN8">输出电压跟随</li><li id="param_func_GN9" data-code="GN9">可调限流</li><li id="param_func_GN10" data-code="GN10">逐波限流</li><li id="param_func_GN11" data-code="GN11">打嗝限流</li><li id="param_func_GN12" data-code="GN12">保护锁死</li><li id="param_func_GN13" data-code="GN13">输出放电</li><li id="param_func_GN14" data-code="GN14">负载断开</li><li id="param_func_GN15" data-code="GN15">频率同步</li><li id="param_func_GN16" data-code="GN16">内置LDO稳压器</li><li id="param_func_GN17" data-code="GN17">内置电流感应电阻</li><li id="param_func_GN18" data-code="GN18">内置感应电阻</li></ul></div></div><div class="once-search-form-item"><h2>引脚数</h2><div class="select packItems" data-type="range" data-id="2478" data-code="PIN"><div class="range-slider"><div id="slider-2478" class="ui-slider ui-slider-vertical ui-widget ui-widget-content ui-corner-all" aria-disabled="false"><div class="ui-slider-range ui-widget-header ui-corner-all" style="bottom: 0%; height: 100%;"></div><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 0%;"></a><a class="ui-slider-handle ui-state-default ui-corner-all" href="#" style="bottom: 100%;"></a></div><div class="slider-input-container" names="param_2478" data-code="PIN"><input type="text" id="range-2478-max" class="slider-input max-input" data-old_value="124" value="124"><input type="text" id="range-2478-min" class="slider-input min-input" data-old_value="3" value="3"></div></div></div><script>
$(function(){	$("#slider-2478").slider({
		orientation: "vertical",
		range: true,
		min: 3,
		max: 124,
		step: 1,
		values: [ 3, 124 ],
		slide: function( event, ui ) {
			$("#range-2478-max").val(ui.values[1]);
			$("#range-2478-min").val(ui.values[0]);
		},
		change: function( event, ui ) {
			rangeChange(2478,"PIN","");
			getSearchCfgCount();
		}
	});
	$("#range-2478-max").on("change", function(){		$("#slider-2478").slider("option","values", [$("#range-2478-min").val(), $("#range-2478-max").val()]);
		getSearchCfgCount();
	});
	$("#range-2478-min").on("change", function(){		$("#slider-2478").slider("option","values", [$("#range-2478-min").val(), $("#range-2478-max").val()]);
		getSearchCfgCount();
	});
});
</script></div><div class="once-search-form-item"><h2>封装系列</h2><div class="select packItems" data-type="select" data-id="445" data-code="PKG1"><ul names="param_445" data-type="multiple"><li id="param_445_SOT23" data-code="SOT23">SOT23</li><li id="param_445_SOT89" data-code="SOT89">SOT89</li><li id="param_445_SOT563" data-code="SOT563">SOT563</li><li id="param_445_TO220" data-code="TO220">TO220</li><li id="param_445_TO252" data-code="TO252">TO252</li><li id="param_445_TO263" data-code="TO263">TO263</li><li id="param_445_DIP" data-code="DIP">DIP</li><li id="param_445_MSOP" data-code="MSOP">MSOP</li><li id="param_445_SSOP" data-code="SSOP">SSOP</li><li id="param_445_SOIC" data-code="SOIC">SOIC</li><li id="param_445_SON" data-code="SON">SON</li><li id="param_445_DFN" data-code="DFN">DFN</li><li id="param_445_QFN" data-code="QFN">QFN</li><li id="param_445_LGA" data-code="LGA">LGA</li><li id="param_445_CSP" data-code="CSP">CSP</li><li id="param_445_USP" data-code="USP">USP</li><li id="param_445_MLP" data-code="MLP">MLP</li><li id="param_445_SOT583" data-code="SOT583">SOT583</li><li id="param_445_SIP" data-code="SIP">SIP</li><li id="param_445_SOD123" data-code="SOD123">SOD123</li><li id="param_445_TO92" data-code="TO92">TO92</li><li id="param_445_QFP" data-code="QFP">QFP</li><li id="param_445_CFP" data-code="CFP">CFP</li><li id="param_445_BGA" data-code="BGA">BGA</li><li id="param_445_SC70" data-code="SC70">SC70</li><li id="param_445_TO94" data-code="TO94">TO94</li><li id="param_445_SMD" data-code="SMD">SMD</li><li id="param_445_N" data-code="N">N</li><li id="param_445_WBSOIC" data-code="WBSOIC">WBSOIC</li><li id="param_445_OTHER" data-code="OTHER">OTHER</li><li id="param_445_TO236" data-code="TO236">TO236</li><li id="param_445_TSOP" data-code="TSOP">TSOP</li></ul></div></div></div>
				<div class="once-search-tag-list"></div>
				<div class="once-search-result">
					<button class="once-search-btn once-search-btn-clear">清除筛选</button>
					<button class="once-search-btn once-search-btn-confirm">应用筛选</button>
					<div class="once-search-result-text">
						<div class="once-flex">
							<span>筛选结果：</span><i id="search-result-count">100+</i>
						</div>
					</div>
				</div>
			</div>
			<div class="filter-wait" id="search_tips" style="width: 100%; margin-top: 10px; display: none;">
				半导小芯正在为您查找，请稍等
			</div>
			<div class="category-top" id="resultNumBox" style="width: 100%; margin-top: 10px;">
				半导小芯为你找到 <icon id="resultNum">100</icon> 条结果
			</div>
			<div class="result-all" style="width: 100%; ">
				<div class="other-result" id="maybeModelBox" style="display: none;">你要查询的可能是以下型号  <icon id="maybeModel">BQ258</icon></div>
				<div id="searchResult"><div class="result-one" data-modelid="afe8d530-8d64-4f70-bc95-98e57e24421e"><p class="bord">TPS53631</p><p>三相、D-CAP+ 降压 VR12.x 服务器 CPU Vcore</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="41c1e0b2-d6d0-43f2-890e-6e79c3e17b09"><p class="bord">TPS53627</p><p>适用于 Intel VR13 CPU VCORE 和 DDR 存储器的两相 D-CAP+™ 降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="0e57048d-8ce0-403e-80bb-9201061effb6"><p class="bord">TPS51678</p><p>用于 VR12.6 V.CPU 的两相、D-CAP+TM 降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="6d9275b5-ddda-46c6-9b8d-d5a46af3fa79"><p class="bord">TPS51633</p><p>用于 VR12.6/VR12.6+ VCPU 的三相 D-CAP+™ 降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="183adb5f-a750-4429-9946-2a58dfd816ba"><p class="bord">TPS51632</p><p>适用于 Nvidia Tegra® T40 CPU 的 2.5V 至 24V、三相/两相/单相降压无驱动器控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="4a2b002b-9597-4d19-8e9c-e5c2650ef7df"><p class="bord">TPS51631A</p><p>用于 VR12.5 Vcpu 的三相 D-CAP+™ 降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="a9b2a274-c782-40f7-b18c-e8d82eb6fd9a"><p class="bord">TPS51631</p><p>用于 VR12.5 CPU 的三相 DCAP+ 降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="50bb5e77-b34c-4676-aa7d-0e92c4a095da"><p class="bord">TPS51624</p><p>适用于 Intel VR12.6 CPU 的 4.5V 至 28V、单相/两相降压无驱动控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="8c263b39-4514-42ac-a79b-2ba005c98310"><p class="bord">TPS51623</p><p>适用于 VR12.1 Vcpu 的两相 D-CAP™ 模式降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="08eff3ad-3e64-4712-bb9b-744520519d9c"><p class="bord">TPS51622A</p><p>用于 VR12.6 Vcpu 的两相 D-CAP+™ 降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="6ffd43de-5e21-403f-86e6-6c4c9636a974"><p class="bord">TPS51622</p><p>用于 VR12.6 CPU 的双相 DCAP+ 降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="5fbb4339-de29-4716-b968-99a07acc2fec"><p class="bord">TPS51621</p><p>用于 IMVP6.5 CPU/GPU Vcore 的双相 D-CAP+™ 模式降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="0ef5de62-eaec-4fd0-9680-c1b1ee9ddc38"><p class="bord">TPS51620</p><p>用于 IMVP6+ CPU/GPU Vcore 的双相 D-CAP+™ 模式降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="1e23aa8b-f2fe-4e4d-9878-638df8fcd096"><p class="bord">TPS51611</p><p>用于 IMVP6.5™ CPU/GPU Vcore 的单相 D-CAP+™ 模式降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="6953d7af-0586-40f4-9d0b-544fc198f2aa"><p class="bord">TPS51610</p><p>用于 IMVP6+ CPU/GPU Vcore 的单相 D-CAP+™ 模式降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="e2b732d0-819b-457f-834d-f94992da2906"><p class="bord">TPS40056</p><p>具有跟踪功能的宽输入电压 (10V-40V) 同步降压直流/直流控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="2854ade5-76f8-4f28-8fcb-ccb877bb598b"><p class="bord">UCD9224</p><p>定序功能经过改进的 2MHz、2 轨、四相数字 PWM 降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="7323c094-916d-4d3f-a7ec-704d7a998989"><p class="bord">UCD9222-EP</p><p>支持 4 位、6 位或 8 位 VID 的数字 PWM 系统控制器，UCD9222-EP</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="fddafb96-1523-4d91-81cb-e7d850b01fdd"><p class="bord">UCD9222</p><p>具有 4/6/8 位并行 VID 的双相数字 PWM 降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="8ee8151b-739b-4f27-9eeb-ecaa33344372"><p class="bord">TPS62701</p><p>用于具有内置时钟 Dittering 电路和锡的射频功率放大器的 2MHz 650mA 降压转换器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="105aaf22-c087-44c8-8299-836f800f71ce"><p class="bord">TPS62700</p><p>用于射频功率放大器的 2MHz 650mA 降压转换器，采用微型 8 引脚 WCSP 封装</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="5eed9d64-e786-4040-b445-50d540a7f1f6"><p class="bord">TPS62366B</p><p>具有 I2C 兼容接口和遥感的 4A 处理器电源</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="adecf513-2015-4745-b089-3b61afe5cb32"><p class="bord">TPS62366A</p><p>具有 I2C 兼容接口和遥感的 4A 处理器电源</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="ba2cb0bc-a526-4cce-9423-f722b0e8acfb"><p class="bord">TPS62363</p><p>具有 I2C 兼容接口和遥感功能的处理器核心电源</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="76728089-58e4-4e95-a5c0-fc2cbac88e01"><p class="bord">TPS62362</p><p>具有 I2C 兼容接口和遥感功能的处理器核心电源.0.77 至 1.4V 输出电压</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="545d8874-c269-4da4-8af2-f22a2afe58bf"><p class="bord">TPS62361B</p><p>具有 I2C 兼容接口和遥感功能的处理器核心电源.0.5 至 1.77 V 输出电压</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="d9dc6dd7-20b9-4d78-91b4-f0c05c8a135a"><p class="bord">TPS62360</p><p>具有 I2C 兼容接口和遥感功能的处理器核心电源.0.77 至 1.4V 输出电压</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="b05ab741-9bba-41fb-9cfd-4e69ad2bec58"><p class="bord">TPS59650</p><p>双通道（三相 CPU/两相 GPU）SVID、D-CAP+™ 降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="5a5285af-fb3a-4526-a677-301454a0fd07"><p class="bord">TPS59641</p><p>具有 1.1V VBoot、适用于 IMVP-7 Vcore 的双通道 SVID、D-CAP+ 工业级降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div><div class="result-one" data-modelid="7faf101a-a894-4683-b41b-a928bcda8a3c"><p class="bord">TPS59640</p><p>具有 0V VBoot、适用于 IMVP-7 Vcore 的双通道 SVID、D-CAP+ 工业级降压控制器</p><div class="right-type"><div class="type-replace type-replace-no"></div><div class="type-detail">德州仪器-TI</div></div></div></div>
			</div>
			<div id="pagination"><div class="whj_jqueryPaginationCss-1"><div class="whj_border whj_padding whj_bgc whj_hover" name="whj_previousPage"> &lt; </div><div class="whj_border whj_padding whj_bgc whj_hover" name="whj_page" data-page="1">1</div><div class="whj_border whj_padding whj_bgc whj_hover" name="whj_page" data-page="2">2</div><div class="whj_border whj_padding whj_bgc whj_checked" name="whj_page" data-page="3">3</div><div class="whj_border whj_padding whj_bgc whj_hover" name="whj_page" data-page="4">4</div><div class="whj_border whj_padding whj_bgc whj_hover" name="whj_nextPage"> &gt; </div></div></div>
		</div>

		<div class="home-foot">
			<img src="/static/img/foot-2.png"> 版权所有：半导科技@2017 SEMIEE <a href="https://beian.miit.gov.cn">闽ICP备17018418号-1</a>
		</div>
		









<!--分类导航-->


    
    
        <div class="categoryNav categoryNavSmall">
            <div class="nav-title nav-title-small" style="display: flex"><div class="option-item-tittle-small" style="display: none"><span>全部</span><span>分类</span></div><div class="option-item-icon"></div></div>
    

    <div class="nav-content">
        <div class="nav-list">
            <ul class="nav-level nav-level-1"><li class="on" data-id="94" data-name="电源管理"><a href="javascript:;">电源管理</a></li><li data-id="134" data-name="信号链"><a href="javascript:;">信号链</a></li><li data-id="327" data-name="MCU微控制器"><a href="javascript:;">MCU微控制器</a></li><li data-id="177" data-name="处理器"><a href="javascript:;">处理器</a></li><li data-id="249" data-name="存储器"><a href="javascript:;">存储器</a></li><li data-id="1039" data-name="无线芯片"><a href="javascript:;">无线芯片</a></li><li data-id="869" data-name="接口芯片"><a href="javascript:;">接口芯片</a></li><li data-id="1970" data-name="专用芯片"><a href="javascript:;">专用芯片</a></li><li data-id="157" data-name="芯片式传感器"><a href="javascript:;">芯片式传感器</a></li><li data-id="1537" data-name="机电式传感器"><a href="javascript:;">机电式传感器</a></li><li data-id="1194" data-name="SiC/GaN"><a href="javascript:;">SiC/GaN</a></li><li data-id="1578" data-name="MOS/IGBT"><a href="javascript:;">MOS/IGBT</a></li><li data-id="170" data-name="晶体管/晶闸管"><a href="javascript:;">晶体管/晶闸管</a></li><li data-id="308" data-name="二极管"><a href="javascript:;">二极管</a></li><li data-id="498" data-name="保护器件"><a href="javascript:;">保护器件</a></li><li data-id="1579" data-name="光电器件"><a href="javascript:;">光电器件</a></li><li data-id="266" data-name="射频器件"><a href="javascript:;">射频器件</a></li><li data-id="1549" data-name="模块/开发板"><a href="javascript:;">模块/开发板</a></li><li data-id="1087" data-name="电阻"><a href="javascript:;">电阻</a></li><li data-id="1112" data-name="电容"><a href="javascript:;">电容</a></li><li data-id="1141" data-name="电感/变压器"><a href="javascript:;">电感/变压器</a></li><li data-id="1166" data-name="晶振/滤波器"><a href="javascript:;">晶振/滤波器</a></li><li data-id="2531" data-name="继电器/接触器"><a href="javascript:;">继电器/接触器</a></li><li data-id="2492" data-name="连接器"><a href="javascript:;">连接器</a></li><li data-id="2616" data-name="仪器设备"><a href="javascript:;">仪器设备</a></li><li data-id="1944" data-name="其它"><a href="javascript:;">其它</a></li></ul>
            <ul class="nav-level nav-level-2"><li class="on" data-id="108" data-name="AC-DC控制器"><a href="javascript:;">AC-DC控制器</a></li><li data-id="95" data-name="DC-DC稳压器"><a href="javascript:;">DC-DC稳压器</a></li><li data-id="101" data-name="LDO稳压器"><a href="javascript:;">LDO稳压器</a></li><li data-id="119" data-name="电池管理"><a href="javascript:;">电池管理</a></li><li data-id="602" data-name="USB-C充电控制"><a href="javascript:;">USB-C充电控制</a></li><li data-id="103" data-name="功率驱动器"><a href="javascript:;">功率驱动器</a></li><li data-id="123" data-name="电源开关"><a href="javascript:;">电源开关</a></li><li data-id="472" data-name="电源保护"><a href="javascript:;">电源保护</a></li><li data-id="391" data-name="电源监视"><a href="javascript:;">电源监视</a></li><li data-id="127" data-name="无线充电"><a href="javascript:;">无线充电</a></li><li data-id="507" data-name="以太网供电"><a href="javascript:;">以太网供电</a></li><li data-id="114" data-name="LED照明-DC/DC"><a href="javascript:;">LED照明-DC/DC</a></li><li data-id="335" data-name="LED照明-AC/DC"><a href="javascript:;">LED照明-AC/DC</a></li><li data-id="125" data-name="参考基准"><a href="javascript:;">参考基准</a></li><li data-id="361" data-name="显示电源"><a href="javascript:;">显示电源</a></li><li data-id="365" data-name="PMIC"><a href="javascript:;">PMIC</a></li><li data-id="130" data-name="特殊电源"><a href="javascript:;">特殊电源</a></li><li data-id="2433" data-name="电源管理(未细分)"><a href="javascript:;">电源管理(未细分)</a></li></ul>
            <ul class="nav-level nav-level-3"><li class="on" data-id="109" data-name="原边反激控制器"><a href="javascript:;">原边反激控制器</a></li><li data-id="323" data-name="副边反激控制器"><a href="javascript:;">副边反激控制器</a></li><li data-id="2421" data-name="反激控制器(未细分)"><a href="javascript:;">反激控制器(未细分)</a></li><li data-id="111" data-name="PWM控制器"><a href="javascript:;">PWM控制器</a></li><li data-id="113" data-name="同步整流器"><a href="javascript:;">同步整流器</a></li><li data-id="389" data-name="非隔离AC-DC"><a href="javascript:;">非隔离AC-DC</a></li><li data-id="110" data-name="PFC功率因数校正"><a href="javascript:;">PFC功率因数校正</a></li><li data-id="557" data-name="反馈信号发生器"><a href="javascript:;">反馈信号发生器</a></li><li data-id="558" data-name="LLC谐振控制器"><a href="javascript:;">LLC谐振控制器</a></li><li data-id="559" data-name="正激控制器"><a href="javascript:;">正激控制器</a></li><li data-id="560" data-name="半桥控制器"><a href="javascript:;">半桥控制器</a></li><li data-id="562" data-name="全桥控制器"><a href="javascript:;">全桥控制器</a></li><li data-id="565" data-name="推挽控制器"><a href="javascript:;">推挽控制器</a></li><li data-id="561" data-name="相移全桥控制器"><a href="javascript:;">相移全桥控制器</a></li><li data-id="564" data-name="负载均分器"><a href="javascript:;">负载均分器</a></li><li data-id="563" data-name="交流过零检测"><a href="javascript:;">交流过零检测</a></li><li data-id="1600" data-name="输入启动芯片"><a href="javascript:;">输入启动芯片</a></li><li data-id="2683" data-name="PSR加速器"><a href="javascript:;">PSR加速器</a></li></ul>
        </div>
    </div>
</div>
<script>
    $(function() {
        $('.categoryNav').hover(function() {
            $(".nav-content").show();
            if($(this).hasClass("categoryNavSmall")) {
                
                $(".nav-title-small").css("width", "73px")
                $(".nav-title-small .option-item-tittle-small").show()
                $(this).css({"padding":"35px 35px 35px 0", "top":"61px"})
            } else {
                $(this).css({"padding":"35px 35px 35px 0", "top":"81px"})
            }
        },function() {
            $(".nav-content").hide();
            if($(this).hasClass("categoryNavSmall")) {
                
                $(".nav-title-small").css("width", "14px")
                $(".nav-title-small .option-item-tittle-small").hide()
                $(this).css({"padding":"0", "top":"96px"})
            } else {
                $(this).css({"padding":"0", "top":"116px"})
            }
        })
        $('.nav-level-1').on('mouseenter','li', function(){
            $(this).addClass('on').siblings('li').removeClass('on');
            loadChild($(this).data('id'),2);
        })
        $('.nav-level-2').on('mouseenter','li', function(){
            $(this).addClass('on').siblings('li').removeClass('on');
            loadChild($(this).data('id'),3);
        })

        $('.nav-level-3').on('mouseenter','li', function(){
            $(this).addClass('on').siblings('li').removeClass('on');
        })
        $('.nav-level-3').on('click','li', function(){
            let userToken = getToken();

            if (userToken) {
                window.location.href = ctx + '/category?classifyId=' + $(this).data('id') + '&classifyName=' + $(this).data('name');
            } else {
                openLogin();
            }
        })
        loadChild(-1,1);
    })

    function openLogin() {
        $('.register .loding li').eq(0).addClass('active').siblings('li').removeClass('active');
        $('.regist-forone').eq(0).show().siblings('.regist-forone').hide();
        $("input[name='loginPhone']").val('');
        $("input[name='loginPassword']").val('');
        $("input[name='registerValidCode']").val('');
        $("input[name='registerPhone']").val('');
        $("input[name='registerPassword']").val('');
        $("#passwordLoginChangeBtn").click();
        $(".login-type-change").show();
        layer.open({
            type: 1,
            title: false,
            closeBtn: 1,
            area: ['400px', '521px'],
            skin: 'layui-layer-nobg', //没有背景色
            shadeClose: true,
            content: $('.J-loding')
        });
    }

    function loadChild(id,level) {
        ddGet("/classify/list", {parentClassifyId:id}, function (dd) {
            if (dd.result) {
                var htm = '';
                for (var key in dd.result) {
                    htm += '<li ';
                    if (key == 0) {
                        htm += 'class = "on" '
                    }
                    htm += 'data-id="'+ dd.result[key]['id'] +'" data-name="'+dd.result[key]['name']+'"><a href="javascript:;">' + dd.result[key]['name'] + '</a></li>';
                }
                $(".nav-level-"+level).html(htm);
                if (level<3) {
                    level += 1;
                    loadChild(dd.result[0]['id'], level);
                }
            }
        }, function (msg) {
        }, false);

        $(".nav-title").off('click').on('click', function(event) {
            event.preventDefault();
            event.stopPropagation(); // 防止事件冒泡
            window.open(ctx + '/classify/index.html');
        });
    }
</script>



    
    
        <div class="carCategoryNav carCategoryNavSmall">
        <div class="car-nav-title car-nav-title-small" style="display: flex"><div class="option-item-tittle-small" style="display: none"><span>汽车</span><span>电子</span></div><div class="option-item-icon"></div></div>
    

<div class="car-nav-content">
    <div class="car-nav-list">
        <ul class="car-nav-level car-nav-level-1"><li class="on" data-id="94"><a href="javascript:;">电源管理</a></li><li data-id="134"><a href="javascript:;">信号链</a></li><li data-id="327"><a href="javascript:;">MCU微控制器</a></li><li data-id="177"><a href="javascript:;">处理器</a></li><li data-id="249"><a href="javascript:;">存储器</a></li><li data-id="1039"><a href="javascript:;">无线芯片</a></li><li data-id="869"><a href="javascript:;">接口芯片</a></li><li data-id="1970"><a href="javascript:;">专用芯片</a></li><li data-id="157"><a href="javascript:;">芯片式传感器</a></li><li data-id="1537"><a href="javascript:;">机电式传感器</a></li><li data-id="1194"><a href="javascript:;">SiC/GaN</a></li><li data-id="1578"><a href="javascript:;">MOS/IGBT</a></li><li data-id="170"><a href="javascript:;">晶体管/晶闸管</a></li><li data-id="308"><a href="javascript:;">二极管</a></li><li data-id="498"><a href="javascript:;">保护器件</a></li><li data-id="1579"><a href="javascript:;">光电器件</a></li><li data-id="266"><a href="javascript:;">射频器件</a></li><li data-id="1549"><a href="javascript:;">模块/开发板</a></li><li data-id="1087"><a href="javascript:;">电阻</a></li><li data-id="1112"><a href="javascript:;">电容</a></li><li data-id="1141"><a href="javascript:;">电感/变压器</a></li><li data-id="1166"><a href="javascript:;">晶振/滤波器</a></li><li data-id="2531"><a href="javascript:;">继电器/接触器</a></li><li data-id="2492"><a href="javascript:;">连接器</a></li></ul>
        <ul class="car-nav-level car-nav-level-2"><li class="on" data-id="108"><a href="javascript:;">AC-DC控制器</a></li><li data-id="95"><a href="javascript:;">DC-DC稳压器</a></li><li data-id="101"><a href="javascript:;">LDO稳压器</a></li><li data-id="119"><a href="javascript:;">电池管理</a></li><li data-id="602"><a href="javascript:;">USB-C充电控制</a></li><li data-id="103"><a href="javascript:;">功率驱动器</a></li><li data-id="123"><a href="javascript:;">电源开关</a></li><li data-id="472"><a href="javascript:;">电源保护</a></li><li data-id="391"><a href="javascript:;">电源监视</a></li><li data-id="127"><a href="javascript:;">无线充电</a></li><li data-id="114"><a href="javascript:;">LED照明-DC/DC</a></li><li data-id="335"><a href="javascript:;">LED照明-AC/DC</a></li><li data-id="125"><a href="javascript:;">参考基准</a></li><li data-id="361"><a href="javascript:;">显示电源</a></li><li data-id="365"><a href="javascript:;">PMIC</a></li><li data-id="130"><a href="javascript:;">特殊电源</a></li><li data-id="2433"><a href="javascript:;">电源管理(未细分)</a></li></ul>
        <ul class="car-nav-level car-nav-level-3"><li class="on" data-id="109"><a href="javascript:;">原边反激控制器</a></li><li data-id="323"><a href="javascript:;">副边反激控制器</a></li><li data-id="2421"><a href="javascript:;">反激控制器(未细分)</a></li><li data-id="113"><a href="javascript:;">同步整流器</a></li><li data-id="111"><a href="javascript:;">PWM控制器</a></li><li data-id="389"><a href="javascript:;">非隔离AC-DC</a></li><li data-id="110"><a href="javascript:;">PFC功率因数校正</a></li><li data-id="557"><a href="javascript:;">反馈信号发生器</a></li><li data-id="558"><a href="javascript:;">LLC谐振控制器</a></li><li data-id="565"><a href="javascript:;">推挽控制器</a></li><li data-id="561"><a href="javascript:;">相移全桥控制器</a></li></ul>
    </div>
</div>
</div>
<script>
    $(function() {
        $('.carCategoryNav').hover(function() {
            $(".car-nav-content").show();
            if($(this).hasClass("carCategoryNavSmall")) {
                $(this).css({"padding":"35px 35px 35px 0", "top":"129px", "z-index": "100"})
                $(".car-nav-title-small").css("width", "73px")
                
                $(".car-nav-title-small .option-item-tittle-small").show()
            } else {
                $(this).css({"padding":"35px 35px 35px 0", "top":"133px"})
            }
        },function() {
            $(".car-nav-content").hide();
            if($(this).hasClass("carCategoryNavSmall")) {
                
                $(".car-nav-title-small").css("width", "14px")
                $(this).css({"padding":"0", "top":"164px", "z-index": "98"})
                $(".car-nav-title-small .option-item-tittle-small").hide()
            } else {
                $(this).css({"padding":"0", "top":"168px"})
            }
        })
        $('.car-nav-level-1').on('mouseenter','li', function(){
            $(this).addClass('on').siblings('li').removeClass('on');
            loadCarChild($(this).data('id'),2);
        })
        $('.car-nav-level-2').on('mouseenter','li', function(){
            $(this).addClass('on').siblings('li').removeClass('on');
            loadCarChild($(this).data('id'),3);
        })

        $('.car-nav-level-3').on('mouseenter','li', function(){
            $(this).addClass('on').siblings('li').removeClass('on');
        })
        $('.car-nav-level-3').on('click','li', function(){
            let userToken = getToken();

            if (userToken) {
                window.location.href = ctx + '/category?classifyId=' + $(this).data('id') + "&car=1";
            } else {
                openLogin();
            }
        })
        loadCarChild(-1,1);
    })

    function openLogin() {
        $('.register .loding li').eq(0).addClass('active').siblings('li').removeClass('active');
        $('.regist-forone').eq(0).show().siblings('.regist-forone').hide();
        $("input[name='loginPhone']").val('');
        $("input[name='loginPassword']").val('');
        $("input[name='registerValidCode']").val('');
        $("input[name='registerPhone']").val('');
        $("input[name='registerPassword']").val('');
        $("#passwordLoginChangeBtn").click();
        $(".login-type-change").show();
        layer.open({
            type: 1,
            title: false,
            closeBtn: 1,
            area: ['400px', '521px'],
            skin: 'layui-layer-nobg', //没有背景色
            shadeClose: true,
            content: $('.J-loding')
        });
    }

    function loadCarChild(id,level) {
        ddGet("/car/classify/list", {parentClassifyId:id}, function (dd) {
            if (dd.result) {
                var htm = '';
                for (var key in dd.result) {
                    htm += '<li ';
                    if (key == 0) {
                        htm += 'class = "on" '
                    }
                    htm += 'data-id="'+ dd.result[key]['id'] +'"><a href="javascript:;">' + dd.result[key]['name'] + '</a></li>';
                }
                $(".car-nav-level-"+level).html(htm);
                if (level<3) {
                    level += 1;
                    loadCarChild(dd.result[0]['id'], level);
                }
            }
        }, function (msg) {
        }, false);

        $(".car-nav-title").off('click').on('click', function(event) {
            event.preventDefault();
            event.stopPropagation(); // 防止事件冒泡
            window.open(ctx + '/car/classify/index.html');
        });
    }
</script>



    
    
        <div class="crossNav crossNavSmall">
        <div class="cross-nav-title cross-nav-title-small" style="display: flex"><div class="option-item-tittle-small" style="display: none"><span>交叉</span><span>参考</span></div><div class="option-item-icon"></div></div>
    

</div>
<script>
    $(function() {
        $('.crossNav').hover(function() {
            if($(this).hasClass("crossNavSmall")) {
                $(this).css({"padding":"35px 35px 35px 0", "top":"197px"})
                $(".cross-nav-title-small").css("width", "73px")
                $(".cross-nav-title-small .option-item-tittle-small").show()
            }
        },function() {
            if($(this).hasClass("crossNavSmall")) {
                $(".cross-nav-title-small").css("width", "14px")
                $(".cross-nav-title-small .option-item-tittle-small").hide()
            }
        })

        $(".cross-nav-title").off('click').on('click', function(event) {
            event.preventDefault();
            event.stopPropagation(); // 防止事件冒泡
            window.open(ctx + '/cross/brand');
        });
    });

</script>




















































































































































    
    
        <div class="sampleCategoryNav sampleCategoryNavSmall">
        <div class="sample-nav-title sample-nav-title-small" style="display: flex"><div class="option-item-tittle-small" style="display: none"><span>厂家</span><span>样品</span></div><div class="option-item-icon"></div></div>
    

</div>
<script>
    $(function () {
        $('.sampleCategoryNav').hover(function() {
            if($(this).hasClass("sampleCategoryNavSmall")) {
                $(this).css({"padding":"35px 35px 35px 0", "top":"265px"})
                $(".sample-nav-title-small").css("width", "73px")
                $(".sample-nav-title-small .option-item-tittle-small").show()
            }
        },function() {
            if($(this).hasClass("sampleCategoryNavSmall")) {
                $(".sample-nav-title-small").css("width", "14px")
                $(".sample-nav-title-small .option-item-tittle-small").hide()
            }
        })

        $('.sampleCategoryNav').off('click').on('click', function () {
            // let token = getToken();
            // if (!token) {
            //     openLogin();
            //     return
            // }
            window.open(ctx + '/sample/index');
        });
    });
</script>

<!--下载app-->

    
    
        <div class="appdowm appDownSmall" style="display: flex">

            <div class="down-item-tittle-small" style="display: none"><span>下载</span><span>APP</span></div>
            <div class="down-item-icon"></div>
        </div>
    

<script language="JavaScript">
    $('.appdowm').hover(function () {
        if ($(this).hasClass("appDownSmall")) {
            
            $(".down-item-tittle-small").show();
            $(this).css("width", "73px");
        }
    }, function () {
        if ($(this).hasClass("appDownSmall")) {
            
            $(".down-item-tittle-small").hide();
            $(this).css("width", "14px");
        }
    })
</script>
<div class="foot-two">
    <div class="foot-two-img">
        <div class="foot-close">
            <img src="/static/img/close-2.png">
        </div>
    </div>
</div>

<script>
    $('.appdowm').on('click', function () {
        $('.foot-two').show();
        $(this).hide();
    });
    $('.foot-close').on('click', function () {
        $('.foot-two').hide();
        $('.appdowm').show();
    });
</script>

<!--右侧导航-->
<div class="back-top">
    <ul>
        <li id="toTop">
            <img class="off" src="/static/img/home-5.png">
            <img class="on" src="/static/img/home-1.png">
            <p>置顶</p>
        </li>
        <li class="J-idea">
            <img class="off" src="/static/img/home-6.png">
            <img class="on" src="/static/img/home-2.png">
            <p>反馈</p>
        </li>
        <li>
            <img class="off" src="/static/img/home-7.png">
            <img class="on" src="/static/img/home-3.png">
            <p>APP</p>
            <div class="app-two">
                <img src="/static/img/bdxx.jpg">
            </div>
        </li>
        <li class="erwm">
            <img class="off" src="/static/img/home-8.png">
            <img class="on" src="/static/img/home-4.png">
            <p>微信</p>
            <div class="app-two">
                <img src="/static/img/weixin_code.png">
            </div>
        </li>
        <li class="erwm">
            <img class="off" src="/static/img/home-wapp2.png">
            <img class="on" src="/static/img/home-wapp1.png">
            <p>小程序</p>
            <div class="app-two">
                <img src="/static/img/xcxc.jpg">
            </div>
        </li>





    </ul>
</div>

<!--意见反馈-->
<div class="idea">
    <div class="close-botton layui-layer-close"><img src="/static/img/close-1.png"></div>
    <div class="idea-top">
        意见反馈
    </div>
    <div class="idea-back">
        <p>请选择您要反馈的问题类型<span>*</span></p>
        <ul>
            <li data-feedbacktype="3" class="active">新功能建议</li>
            <li data-feedbacktype="2">体验问题</li>
            <li data-feedbacktype="1">功能异常</li>
            <li data-feedbacktype="4">其他</li>
        </ul>
    </div>
    <div class="idea-text">
        <p>反馈内容<span>*</span></p>
        <div class="text">
            <textarea name="feedbackContent" rows="" cols="" placeholder="写点东西吧，我们希望听到您的声音^_^ "></textarea>
        </div>
    </div>
    <div class="idea-text">
        <p>联系方式<span>*</span></p>
        <div class="text">
            <input type="text" name="feedbackContact" value="" placeholder="请留下联系方式，以便我们及时联系您">
        </div>
    </div>
    <div class="button"><button type="button" id="submitFeedback" class="btn" style="position: inherit;margin-top: 10px;">提交</button></div>
</div>
<div style="display: none">
    <script src="https://s19.cnzz.com/z_stat.php?id=1272851447&amp;web_id=1272851447" language="JavaScript">




    </script><script src="https://c.cnzz.com/c.js?web_id=1272851447&amp;t=z" charset="utf-8" type="text/javascript"></script><a href="https://www.cnzz.com/stat/website.php?web_id=1272851447" target="_blank" title="站长统计">站长统计</a>
</div>

<div id="captcha-container" style="text-align:center;margin: 10px;display: none;">
    <canvas id="captcha-canvas" width="120" height="40" style="cursor: pointer;"></canvas>
    <br>
    <div style="padding: 10px 0;">
        <input type="text" id="captcha-input" placeholder="输入验证码" style="outline: none;line-height: 24px;width: 130px;border: 1px solid #e3e3e3;">
        <button id="verify-captcha-btn" style="outline: none;color: #fff; background-color: #337ab7;
					line-height: 24px;cursor: pointer;border: 1px solid transparent;border-radius: 4px;width: 60px;">验证</button>
    </div>
</div>


<script>
    $('.idea .idea-back li').on('click', function () {
        $(this).addClass('active').siblings('li').removeClass('active');
    });
    $('.back-top ul li').hover(function () {
        $(this).find('.on').toggle();
        $(this).find('.off').toggle();
    }, function () {
        $(this).find('.on').toggle();
        $(this).find('.off').toggle();
    });
    //意见反馈
    $('.J-idea').on('click', function () {
        $("input[name='feedbackContact']").val('');
        $("textarea[name='feedbackContent']").val('');
        $(".idea-back li").eq(0).addClass('active').siblings().removeClass('active');
        layer.open({
            type: 1,
            title: false,
            closeBtn: false,
            area: ['900px', 'auto'],
            skin: 'layui-layer-nobg', //没有背景色
            shadeClose: true,
            content: $('.idea')
        });
    });

    // 在线咨询
    $('.J-chat').on('click', function () {
        layer.open({
            type: 1,
            title: '半导小芯小助手',
            closeBtn: 1,
            area: ['990px', 'auto'],
            skin: 'layui-layer-nobg', //没有背景色
            shadeClose: true,
            content: $('.j-chat'),
            success: function(layero, index) {
                initializeWebSocket();
            }
        });
    });
    //提交反馈
    $("#submitFeedback").click(function () {
        var vo = {
            "deviceId": getDeviceId(),
            "contact": $("input[name='feedbackContact']").val(),
            "content": $("textarea[name='feedbackContent']").val(),
            "type": $(".idea-back li[class='active']").data('feedbacktype')
        };
        ddPost("/index/feedback", vo, function (dd) {
            layer.alert('提交成功', {closeBtn: 0}, function () {
                layer.closeAll();
            });
        }, function (msg) {
            layer.alert(msg, {closeBtn: 0});
        }, true);
    });
    //返回顶部
    $("#toTop").click(function () {
        if (document.body.scrollTop == 0) {
            $(document.documentElement).animate({scrollTop: 0}, 200);
        } else {
            $(document.body).animate({scrollTop: 0}, 200);
        }
    });


    // 生成随机验证码
    function generateCaptcha(length = 4) {
        const chars = 'ABCDEFGHJKMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789';
        let captcha = '';
        for (let i = 0; i < length; i++) {
            captcha += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        return captcha;
    }

    // 绘制图形验证码
    function drawCaptcha(captcha, canvasId) {
        const canvas = document.getElementById(canvasId);
        const ctx = canvas.getContext('2d');
        canvas.width = 120;
        canvas.height = 40;

        // 清除画布
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // 设置背景颜色
        ctx.fillStyle = '#f0f0f0';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // 添加干扰线或点以增加复杂度
        for (let i = 0; i < 5; i++) {
            ctx.strokeStyle = randomColor();
            ctx.beginPath();
            ctx.moveTo(Math.random() * canvas.width, Math.random() * canvas.height);
            ctx.lineTo(Math.random() * canvas.width, Math.random() * canvas.height);
            ctx.stroke();
        }

        for (let i = 0; i < 50; i++) {
            ctx.fillStyle = randomColor();
            ctx.beginPath();
            ctx.arc(Math.random() * canvas.width, Math.random() * canvas.height, 1, 0, Math.PI * 2);
            ctx.fill();
        }

        // 绘制验证码字符
        // 计算每个字符应该占用的空间
        const charWidth = canvas.width / captcha.length - 3; // 减去一些边距
        ctx.textBaseline = 'middle';
        ctx.font = 'bold 24px Arial';
        for (let i = 0; i < captcha.length; i++) {
            const xPosition = i * charWidth + charWidth / 2;
            ctx.fillStyle = randomColor();
            ctx.fillText(captcha[i], xPosition, canvas.height / 2);
        }
    }

    // 随机生成背景颜色
    function randomColor() {
        return '#' + Math.floor(Math.random() * 16777215).toString(16);
    }

    // 弹窗图形验证码
    function showCaptchaDialog(callback) {
        // 用于存储最新生成的验证码
        let captcha;

        function generateAndDrawCaptcha() {
            captcha = generateCaptcha();
            drawCaptcha(captcha, 'captcha-canvas');
        }

        layer.open({
            type: 1,
            title: '请输入验证码',
            area: ['300px', 'auto'],
            content: $("#captcha-container"),
            success: function(layero, index) {
                // 初始绘制验证码
                generateAndDrawCaptcha();

                // 给canvas添加点击事件监听器，以更换验证码
                document.getElementById('captcha-canvas').onclick = function () {
                    // 重新生成并绘制新的验证码
                    generateAndDrawCaptcha();
                };

                document.getElementById('verify-captcha-btn').onclick = function () {
                    const userInput = document.getElementById('captcha-input').value;
                    if (!userInput) {
                        layer.msg('请输入验证码', {time: 2000});
                        return;
                    }
                    if (userInput.toLowerCase() === captcha.toLowerCase()) {
                        layer.close(index);
                        // 验证通过，执行回调
                        callback(true);
                    } else {
                        layer.msg('验证码错误，请重试', {time: 2000});
                        generateAndDrawCaptcha();
                    }
                };
            }
        });
    }
</script>
<div class="successNotification" style="display: none" id="copyNotification"><img src="/static/img/success-icon.png" alt="" class="success-icon">复制成功</div>
<div class="successNotification" style="display: none" id="likeNotification"><img src="/static/img/success-icon.png" alt="" class="success-icon">关注成功，已经加入到”我的品牌”名单</div>
<div class="successNotification" style="display: none" id="cancelLikeNotification"><img src="/static/img/success-icon.png" alt="" class="success-icon">取消关注成功</div>
<div class="failNotification" style="display: none;" id="failNotification"></div>
<div class="successNotification" style="display: none;" id="successNotification"></div>
		<!--登录-->
		<div class="once-msg">
			<div class="once-msg-logo"><img src="/static/img/resigin-1.png"></div>
			<div class="once-msg-content">
				<p>已经达到每日限制次数</p>
				<p>请联系运营人员提高权限</p>
			</div>
			<div class="once-msg-footer">
				微信号：semi2026
			</div>
		</div>
	
	<style>
		.ui-slider-vertical{width: 4px; height: 170px; background: #e5e5e5; border: 0;}
		.ui-widget-header{background: #3369cd;}
		.ui-slider {margin-left: 10px;display: inline-block;}
		.ui-slider .ui-slider-handle{width:20px; height: 20px; border-radius: 10px}
		.ui-slider-vertical .ui-slider-handle{left: -8px; margin-bottom: -10px}
		.ui-slider a:hover, .ui-slider a:focus{outline: none !important}
		.ui-state-default, .ui-widget-content .ui-state-default, .ui-widget-header .ui-state-default,.ui-state-active,.ui-widget-content .ui-state-active,.ui-widget-header .ui-state-active{border:1px solid #3369cd; background: #ffffff;}
		.ui-state-hover, .ui-widget-content .ui-state-hover, .ui-widget-header .ui-state-hover, .ui-state-focus, .ui-widget-content .ui-state-focus, .ui-widget-header .ui-state-focus{background: #fff;}
	</style>
	<script>
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
	</script>


	<script type="text/javascript">
        var pageIndex = 0;
        var pageSize = 30;
        var classifyId = '96';
        var classifyName = '';
        var brandId = '14';
        var brandUid = '8d190e00196ba9502099586b881b1abb';
		var car = '';
		var appClassifyId = '';
		var brandPersonalClassifyId = '';
        var recommendModel;

        function initSearchResultEvent() {
            $(".result-one").unbind("click").click(function () {
                var modelId = $(this).data('modelid');
                window.open(ctx + '/' + modelId + ".html");
            });
        }

        $(function () {
			$('.once-search-form').on('click','li', function() {
				var ul = $(this).parent();

				if (!$(this).hasClass("active")) {
					if (ul.data("type") === "single") {
						$('ul[names="'+ ul.attr("names") +'"] > li').each(function() {
							if ($(this).hasClass("active")) {
								$(this).removeClass("active");
							}
						})
						$('div[key="'+ul.attr("names")+'"]').remove();
					}

					$(this).addClass("active");
					addTag($(this).parent("ul").attr("names"),$(this).data("code"), $(this).html());
				} else {
					var code = $(this).data("code");
					$(this).removeClass("active");
					$('div[key="'+ul.attr("names")+'"]').each(function () {
						if ($(this).data("code") === code) {
							$(this).remove();
						}
					})
					getSearchCfgCount();
				}
			});
			$('.once-search-tag-list').on('click','.clear-one', function() {
			    if ($(this).data("type")=="select") {
                    $('#' + $(this).data("names")).removeClass("active");
                }
			    if ($(this).data("type")=="range") {
			        var id= $(this).data('id');
                    $("#range-"+id+"-min").val($("#range-"+id+"-min").data("old_value"));
                    $("#range-"+id+"-max").val($("#range-"+id+"-max").data("old_value"));
                    $("#slider-"+id).slider("option","values", [$("#range-"+id+"-min").data("old_value"), $("#range-"+id+"-max").data("old_value")]);
                }
				$(this).parent("div").remove();
				getSearchCfgCount();
			});

			//清除筛选点击
			$('.once-search-btn-clear').on('click', function() {
				searchCfgFunc();
				$('.once-search-tag-list').html('');
			})

			//应用筛选点击
			$('.once-search-btn-confirm').on('click', function() {
				searchModelFunc();

                var brands = "";
                var param = "";
                $('.once-search-tag-list>.once-search-tag').each(function() {
                    if ($(this).attr("key") == "param_brand") {
                        brands += '“'+$(this).children("span").html()+'”,'
                    } else  {
                        param += '“'+$(this).children("span").html()+'”,'
                    }
                })
                if (brands != "") {
                    var vo = {};
                    vo.type = 34;
                    vo.content = "选择了：" + brands
                    vo.source = 1;
                    vo.os = 2;
                    vo.classifyId = classifyId;
                    ddPost("/operatorlog/upload", vo, function (dd) {
                    }, function (msg) {
                    }, true);
                }

                if (param != "") {
                    var vo = {};
                    vo.type = 33;
                    vo.content = "选择了：" + param
                    vo.source = 1;
                    vo.os = 2;
                    vo.classifyId = classifyId;
                    ddPost("/operatorlog/upload", vo, function (dd) {
                    }, function (msg) {
                    }, true);
                }
			})
		})

		function addTag(names, code, name) {
			var htm = '';
			htm += '<div class="once-search-tag" key="'+names+'" data-code="'+code+'">\n' +
					'	<span>'+name+'</span>\n' +
					'	<a href="javascript:;" data-type="select" data-names="'+names+'_'+code+'" class="clear-one"></a>\n' +
					'</div>';
			$('.once-search-tag-list').append(htm);
			getSearchCfgCount();
		}

		function getSearchCfgCount() {
			var vo = {
				"classifyId": classifyId,
				"brands": getSelectedBrands(),
				"searchItems": getSelectedSearchItems(),
				"funcItems": getSelectedFuncItems(),
				"packItems": getSelectedPackItems()
			};
			if (car) {
				vo.is_car = car;
			}
			if (appClassifyId) {
				vo.appClassifyId = appClassifyId
			}
			if (brandPersonalClassifyId) {
				vo.brandPersonalClassifyId = brandPersonalClassifyId;
			}
			var url = '/classify/cfg/chip/search/count';
			if (brandId) {
				url = '/classify/cfg/' + brandId + '/chip/search/count'
			}
			ddPost(url, vo, function (dd) {
				if (dd.result) {
					if (brandId) {
						if (dd.result['hasMore']) {
							$("#search-result-count").html(dd.result['total'] + "+");
						} else {
							$("#search-result-count").html(dd.result['total']);
						}
					} else {
						if (dd.result['hasMore']) {
							$("#search-result-count").html("30+");
						} else {
							$("#search-result-count").html(dd.result['total']);
						}
					}
				}
			})
		}

        function refresh() {
			searchModelFunc();
        }

        function getSelectedBrands() {
        	var brands = [];
        	$('ul[names="param_brand"] > li').each(function(){
        		if ($(this).hasClass("active")) {
        			brands.push($(this).data("code"));
				}
			})
			if (brandId) {
				brands.push(Number(brandId))
			}
			return brands;
		}

		function getSelectedFuncItems() {
			var funcItems = [];
			$('ul[names="param_func"] > li').each(function(){
				if ($(this).hasClass("active")) {
					var vo = {
						"code": $(this).data("code")
					};
					funcItems.push(vo)
				}
			})
			return funcItems;
		}

		function getSelectedSearchItems() {
        	var searchItems = [];
        	$('.searchItems').each(function() {
        		if ($(this).data("type") == "select") {
        			var packDict = getSelectedSearchItemsOption($(this).data("id"));
        			if (packDict != "") {
						var vo = {
							"code": $(this).data("code"),
							"dictCode": packDict
						};
						searchItems.push(vo)
					}
				} else {
        			if ($('#range-'+$(this).data("id")+'-max').val() != $('#range-'+$(this).data("id")+'-max').data("old_value") || $('#range-'+$(this).data("id")+'-min').val() != $('#range-'+$(this).data("id")+'-min').data("old_value")) {
						var vo = {
							"code": $(this).data("code"),
							"max_select_value": $('#range-'+$(this).data("id")+'-max').val(),
							"min_select_value": $('#range-'+$(this).data("id")+'-min').val()
						};
						searchItems.push(vo)
					}
				}
			})
			return searchItems;
		}

		function getSelectedSearchItemsOption(id) {
        	var item = "";
        	$('ul[names="param_'+id+'"] > li').each(function(){
        		if ($(this).hasClass("active")) {
        			 item = $(this).data("code").toString();
				}
			})
			return item;
		}

		function getSelectedPackItems() {
			var packItems = [];
			$('.packItems').each(function() {
				if ($(this).data("type") == "select") {
					var packDictCodes = getSelectedPackItemsOption($(this).data("id"));
					if (packDictCodes != "") {
						var vo = {
							"code": $(this).data("code"),
							"packDictCodes": packDictCodes
						};
						packItems.push(vo)
					}
				} else {
					if ($('#range-'+$(this).data("id")+'-max').val() != $('#range-'+$(this).data("id")+'-max').data("old_value") || $('#range-'+$(this).data("id")+'-min').val() != $('#range-'+$(this).data("id")+'-min').data("old_value")) {
						var vo = {
							"code": $(this).data("code"),
							"max_select_value": $('#range-' + $(this).data("id") + '-max').val(),
							"min_select_value": $('#range-' + $(this).data("id") + '-min').val()
						};
						packItems.push(vo)
					}
				}
			})
			return packItems;
		}

		function getSelectedPackItemsOption(id) {
			var items = [];
			$('ul[names="param_'+id+'"] > li').each(function(){
				if ($(this).hasClass("active")) {
					items.push($(this).data("code").toString());
				}
			})
			return items;
		}

		searchCfgFunc();
		//searchModelFunc();

        //查询参数筛选项
		function searchCfgFunc() {
			var vo = {
				"classifyId": classifyId
			};
			if (car) {
				vo.isCar = car
			}
			if (appClassifyId) {
				vo.appClassifyId = appClassifyId;
			}
			ddGet("/classify/cfg/searchcfg", vo, function (dd) {
				if (dd.result) {
					// 品牌
					var brands = dd.result['brands'];

					// 如果有 brandId，先获取额外的品牌信息
					if (brandId) {
						updateBrandsWithBrandId(brands, vo, function(updatedBrands) {
							processBrands(updatedBrands, dd.result);
						});
					} else {
						// 如果没有 brandId，直接处理 brands
						processBrands(brands, dd.result);
					}
				}
				getSearchCfgCount();
				searchModelFunc();
			});
		}

		function updateBrandsWithBrandId(brands, vo, callback) {
			ddGet("/classify/cfg/" + brandId + "/searchcfg", vo, function (res) {
				if (res.result) {
					// 将现有品牌的 id 存储在一个 Set 中
					const existingIds = new Set(brands.map(brand => brand.id));

					// 过滤新品牌列表，只保留 id 不在现有品牌中的品牌
					const newBrands = res.result['brands'].filter(newBrand => !existingIds.has(newBrand.id));

					// 将过滤后的新品牌添加到现有品牌列表中
					brands.push(...newBrands);
					callback(brands);
				} else {
					callback(brands); // 如果没有额外的品牌信息，直接回调
				}
			});
		}

		function processBrands(brands, result) {
			var onceCategoryHtm = '<a href="/">首页</a> > ';
			if (brandId) {
				$.each(brands, function (index, item) {
					if (item.id === Number(brandId)) {
						onceCategoryHtm += '<a href="/brand/index?brandUid=' + brandUid + '" target="_blank">' + item.name + '</a> > ';
					}
				});
			}
			if (classifyName) {
				onceCategoryHtm += '<span id="cate-text">' + classifyName;
			} else {
				onceCategoryHtm += '<span id="cate-text">' + result['name'];
			}
			if (car && car === '1') {
				onceCategoryHtm += "（汽车级）";
			}
			onceCategoryHtm += '</span>';
			$('.once-search-category').html(onceCategoryHtm);

			var item_html = '';
			item_html += getSearchCfgBrand(brands);

			// 参数
			var searchItems = result['searchItems'];
			for (var key in searchItems) {
				item_html += getSearchCfgItem(searchItems[key]);
			}

			// 功能
			var funcItems = result['funcItems'];
			if (funcItems.length > 0) {
				item_html += getSearchCfgFunc(funcItems);
			}

			// 封装
			var packItems = result['packItems'];
			if (packItems.length > 0) {
				for (var key in packItems) {
					item_html += getSearchCfgPackItem(packItems[key]);
				}
			}

			$('.once-search-form').html(item_html);
		}

		function getSearchCfgFunc(funcItems) {
			var html = '';
			html += '<div class="once-search-form-item">';
			html += '<h2>功能</h2>';
			html += '<div class="select">';

			html += '<ul names="param_func" data-type="multiple">';
			for (var k in funcItems) {
				html += '<li id="param_func_'+funcItems[k]['code']+'" data-code="'+ funcItems[k]['code'] +'">' + funcItems[k]['name'] + '</li>';
			}
			html += '</ul>';

			html += '</div>';
			html += '</div>';
			return html;
		}

		function getSearchCfgBrand(brands) {
			var html = '';
			html += '<div class="once-search-form-item">';
			html += '<h2>品牌</h2>';
			html += '<div class="select">';

			html += '<ul names="param_brand" data-type="multiple">';
			for (var k in brands) {
				if (brandId) {
					if (brands[k]['id'] !== Number(brandId)) {
						continue;
					}
				}
				html += '<li id="param_brand_'+brands[k]['id']+'" data-code="'+ brands[k]['id'] +'">' + brands[k]['name'] + '</li>';
			}
			html += '</ul>';

			html += '</div>';
			html += '</div>';
			return html;
		}

		function getSearchCfgItem(searchItem) {
			var html = '';
			html += '<div class="once-search-form-item">';
			html += '<h2>' + searchItem['name'];
			if (searchItem['unit']) {
				html += '(' + searchItem['unit'] +')';
			}
			html += '</h2>';

			if (searchItem['classifyCfgDict'].length > 0) {
				html += '<div class="select searchItems" data-type="select" data-id="'+searchItem['id']+'" data-code="'+searchItem['code']+'">';
				html += '<ul names="param_'+searchItem['id']+'" data-type="single">';
				for (var k in searchItem['classifyCfgDict']) {
					html += '<li id="param_'+searchItem['id']+'_'+searchItem['classifyCfgDict'][k]['code']+'" data-code="'+ searchItem['classifyCfgDict'][k]['code'] +'">' + searchItem['classifyCfgDict'][k]['name'] + '</li>';
				}
				html += '</ul>';
				html += '</div>';
			} else {
				html += '<div class="select searchItems" data-type="range" data-id="'+searchItem['id']+'" data-code="'+searchItem['code']+'">';
				html += '<div class="range-slider">'+
						'<div id="slider-'+searchItem['id']+'"></div>'+
						'<div class="slider-input-container" names="param_'+searchItem['id']+'" data-code="'+searchItem['code']+'">'+
						'<input type="text" id="range-'+searchItem['id']+'-max" class="slider-input max-input" data-old_value="'+searchItem['max_value']+'" value="'+searchItem['max_value']+'" />'+
						'<input type="text" id="range-'+searchItem['id']+'-min" class="slider-input min-input" data-old_value="'+searchItem['min_value']+'" value="'+searchItem['min_value']+'" />'+
						'</div>'+
						'</div>';
				html += '</div>';
				html += '<script>\n' +
						'$(function(){'+
						'	$("#slider-'+searchItem['id']+'").slider({\n' +
						'		orientation: "vertical",\n' +
						'		range: true,\n' +
						'		min: '+ searchItem['min_value'] +',\n' +
						'		max: '+ searchItem['max_value'] +',\n' +
						'		step: '+ searchItem['scale'] +',\n' +
						'		values: [ '+ searchItem['min_value'] +', '+ searchItem['max_value'] +' ],\n' +
						'		slide: function( event, ui ) {\n' +
						'			$("#range-'+searchItem['id']+'-max").val(ui.values[1]);\n' +
						'			$("#range-'+searchItem['id']+'-min").val(ui.values[0]);\n' +
						'		},\n' +
						'		change: function( event, ui ) {\n' +
                        '			rangeChange('+searchItem['id']+',"'+searchItem['code']+'","'+searchItem['unit']+'");\n' +
						'			getSearchCfgCount();\n' +
						'		}\n' +
						'	});\n' +
						'	$("#range-'+searchItem['id']+'-max").on("change", function(){'+
						'		$("#slider-'+searchItem['id']+'").slider("option","values", [$("#range-'+searchItem['id']+'-min").val(), $("#range-'+searchItem['id']+'-max").val()]);\n' +
						'		getSearchCfgCount();\n' +
						'	});\n' +
						'	$("#range-'+searchItem['id']+'-min").on("change", function(){'+
						'		$("#slider-'+searchItem['id']+'").slider("option","values", [$("#range-'+searchItem['id']+'-min").val(), $("#range-'+searchItem['id']+'-max").val()]);\n' +
						'		getSearchCfgCount();\n' +
						'	});\n' +
						'});\n' +
						'<\/script>';
			}
			html += '</div>';
			return html;
		}

		function getSearchCfgPackItem(packItems) {
			var html = '';
			html += '<div class="once-search-form-item">';
			html += '<h2>' + packItems['name'];
			if (packItems['unit']) {
				html += '(' + packItems['unit'] +')';
			}
			html += '</h2>';

			if (packItems['classifyCfgDict'].length > 0) {
				html += '<div class="select packItems" data-type="select" data-id="'+packItems['id']+'" data-code="'+packItems['code']+'">';
				html += '<ul names="param_'+packItems['id']+'" data-type="multiple">';
				for (var k in packItems['classifyCfgDict']) {
					html += '<li id="param_'+packItems['id']+'_'+packItems['classifyCfgDict'][k]['code']+'" data-code="'+ packItems['classifyCfgDict'][k]['code'] +'">' + packItems['classifyCfgDict'][k]['name'] + '</li>';
				}
				html += '</ul>';
				html += '</div>';
			} else {
				html += '<div class="select packItems" data-type="range" data-id="'+packItems['id']+'" data-code="'+packItems['code']+'">';
				html += '<div class="range-slider">'+
						'<div id="slider-'+packItems['id']+'"></div>'+
						'<div class="slider-input-container" names="param_'+packItems['id']+'" data-code="'+packItems['code']+'">'+
						'<input type="text" id="range-'+packItems['id']+'-max" class="slider-input max-input" data-old_value="'+packItems['max_value']+'" value="'+packItems['max_value']+'" />'+
						'<input type="text" id="range-'+packItems['id']+'-min" class="slider-input min-input" data-old_value="'+packItems['min_value']+'" value="'+packItems['min_value']+'" />'+
						'</div>'+
						'</div>';
				html += '</div>';
				html += '<script>\n' +
						'$(function(){'+
						'	$("#slider-'+packItems['id']+'").slider({\n' +
						'		orientation: "vertical",\n' +
						'		range: true,\n' +
						'		min: '+ packItems['min_value'] +',\n' +
						'		max: '+ packItems['max_value'] +',\n' +
						'		step: '+ packItems['scale'] +',\n' +
						'		values: [ '+ packItems['min_value'] +', '+ packItems['max_value'] +' ],\n' +
						'		slide: function( event, ui ) {\n' +
						'			$("#range-'+packItems['id']+'-max").val(ui.values[1]);\n' +
						'			$("#range-'+packItems['id']+'-min").val(ui.values[0]);\n' +
						'		},\n' +
						'		change: function( event, ui ) {\n' +
                        '			rangeChange('+packItems['id']+',"'+packItems['code']+'","'+packItems['unit']+'");\n' +
						'			getSearchCfgCount();\n' +
						'		}\n' +
						'	});\n' +
						'	$("#range-'+packItems['id']+'-max").on("change", function(){'+
						'		$("#slider-'+packItems['id']+'").slider("option","values", [$("#range-'+packItems['id']+'-min").val(), $("#range-'+packItems['id']+'-max").val()]);\n' +
						'		getSearchCfgCount();\n' +
						'	});\n' +
						'	$("#range-'+packItems['id']+'-min").on("change", function(){'+
						'		$("#slider-'+packItems['id']+'").slider("option","values", [$("#range-'+packItems['id']+'-min").val(), $("#range-'+packItems['id']+'-max").val()]);\n' +
						'		getSearchCfgCount();\n' +
						'	});\n' +
						'});\n' +
						'<\/script>';
			}
			html += '</div>';
			return html;
		}

		function rangeChange(id,code,unit) {
            var maxVal = $("#range-"+id+"-max").val();
            var maxOldVal = $("#range-"+id+"-max").data("old_value");
            var minVal = $("#range-"+id+"-min").val();
            var minOldVal = $("#range-"+id+"-min").data("old_value");

            if (maxOldVal!=maxVal || minVal!=minOldVal) {
                var html = minVal+unit+' - '+maxVal+unit;
                if ($('div[key="param_'+id+'"]').length > 0) {
                    $('div[key="param_'+id+'"]>span').html(html);
                } else {
                    var htm = '';
                    htm += '<div class="once-search-tag" key="param_' + id + '" data-code="' + code + '">\n' +
                        '	<span>' + html + '</span>\n' +
                        '	<a href="javascript:;" data-type="range" data-id="' + id + '" class="clear-one"></a>\n' +
                        '</div>';
                    $('.once-search-tag-list').append(htm);
                }
            } else {
                if ($('div[key="param_'+id+'"]').length > 0) {
                    $('div[key="param_'+id+'"]').remove();
                }
            }
        }

        //搜索芯片型号
        function searchModelFunc() {
            var vo = {
                "pageIndex": pageIndex,
                "pageSize": pageSize,
				"classifyId": classifyId,
				"brands": getSelectedBrands(),
				"searchItems": getSelectedSearchItems(),
				"funcItems": getSelectedFuncItems(),
				"packItems": getSelectedPackItems()
            };
			if (car) {
				vo.is_car = car;
			}
			if (appClassifyId) {
				vo.appClassifyId = appClassifyId
			}
			if (brandPersonalClassifyId) {
				vo.brandPersonalClassifyId = brandPersonalClassifyId;
			}
            $("#search_tips").show();
            $("#resultNumBox").hide();
			var url = '/classify/cfg/chip/search';
			if (brandId) {
				url = '/classify/cfg/' + brandId + '/chip/search'
			}
            ddPost(url, vo, function (dd) {
                var dataHtm = '';
                for (var key in dd.result) {
                    dataHtm += '<div class="result-one" data-modelid="' + dd.result[key]['id'] + '">' +
                        '<p class="bord">' + dd.result[key]['model'] + '</p>' +
                        '<p>' + dd.result[key]['descr'] + '</p>' +
                        '<div class="right-type">';
                    if (dd.result[key]['choice_similar_num'] > 0) {
						dataHtm += '<div class="type-replace">替代</div>';
					} else {
						dataHtm += '<div class="type-replace type-replace-no"></div>';
					}
					dataHtm += '<div class="type-detail">' + dd.result[key]['brand_name'] + '</div></div>' +
                        '</div>';
                }
                var totalPageNum = parseInt(dd.total / pageSize);
                if (totalPageNum * pageSize < dd.total) {
                    totalPageNum++;
                }
                //if(dd.total > 0) {
                	$("#search_tips").hide();
                	$("#resultNumBox").show();
                //}
                // $("#resultNum").html(dd.total >= 50?(dd.total + "+"):dd.total);
				$("#resultNum").html(dd.total);
                $("#searchResult").html(dataHtm);
                initSearchResultEvent();
                // 参数2：当前页数，参数3：总页数
                $("#pagination").whjPaging("setPage", pageIndex + 1, totalPageNum);
            }, function (msg) {
            	if (msg == "已达今天浏览限制次数") {
					layer.open({
						type: 1,
						title: false,
						closeBtn: 1,
						area: ['360px', '379px'],
						skin: 'layui-layer-nobg', //没有背景色
						shadeClose: false,
						content: $('.once-msg')
					});
				} else {
					layer.alert(msg, {closeBtn: 0});
				}
            }, true);
        }

        $("#pagination").whjPaging({
            isResetPage: true,
            isShowFL: false,
            isShowPageSizeOpt: false,
            isShowSkip: false,
            isShowRefresh: false,
            isShowTotalPage: false,
            callBack: function (currPage, pageSize) {
                pageIndex = currPage - 1;
                refresh();
                //点击下一页回到顶部
                $('html,body').animate({scrollTop:0},0)
            }
        });

        //搜索
        $("#search").click(function () {
			searchModel = $("input[name='searchModel']").val();
			if(searchModel != null && searchModel != '') {
				var item = {};
				item.content = searchModel;
				saveHistory(item);
			}
			window.location.href = ctx + '/search?searchModel=' + searchModel;
        });

        $("#maybeModelBox").click(function() {
            searchModel = $("#maybeModel").html();
			window.location.href = ctx + '/search?searchModel=' + searchModel;
        });
	</script>

</body></html>